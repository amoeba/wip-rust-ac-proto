use serde::{Serialize, Deserialize};
use crate::readers::*;
use crate::enums::*;
use crate::messages::c2s;
use crate::messages::s2c;
use crate::gameactions;
use crate::gameevents;

/// Message direction
#[derive(Debug, Clone, Copy, PartialEq, Eq, Serialize, Deserialize)]
pub enum Direction {
    ClientToServer,
    ServerToClient,
}

/// The main message kind enum
#[derive(Debug, Serialize, Deserialize)]
pub enum MessageKind {
    /// Client to Server messages
    C2S(Box<C2SMessage>),
    /// Server to Client messages
    S2C(Box<S2CMessage>),
}

impl MessageKind {
    pub fn read(reader: &mut dyn ACReader, direction: Direction) -> Result<Self, Box<dyn std::error::Error>> {
        match direction {
            Direction::ClientToServer => Ok(MessageKind::C2S(Box::new(C2SMessage::read(reader)?))),
            Direction::ServerToClient => Ok(MessageKind::S2C(Box::new(S2CMessage::read(reader)?))),
        }
    }

    pub fn queue(&self) -> Option<MessageQueue> {
        match self {
            MessageKind::C2S(msg) => msg.queue(),
            MessageKind::S2C(msg) => msg.queue(),
        }
    }
}

/// GameActionMessage enum with message data
#[derive(Debug, Serialize, Deserialize)]
pub enum GameActionMessage {
    CharacterPlayerOptionChangedEvent(gameactions::CharacterPlayerOptionChangedEvent),
    CombatTargetedMeleeAttack(gameactions::CombatTargetedMeleeAttack),
    CombatTargetedMissileAttack(gameactions::CombatTargetedMissileAttack),
    CommunicationSetAFKMode(gameactions::CommunicationSetAFKMode),
    CommunicationSetAFKMessage(gameactions::CommunicationSetAFKMessage),
    CommunicationTalk(gameactions::CommunicationTalk),
    SocialRemoveFriend(gameactions::SocialRemoveFriend),
    SocialAddFriend(gameactions::SocialAddFriend),
    InventoryPutItemInContainer(gameactions::InventoryPutItemInContainer),
    InventoryGetAndWieldItem(gameactions::InventoryGetAndWieldItem),
    InventoryDropItem(gameactions::InventoryDropItem),
    AllegianceSwearAllegiance(gameactions::AllegianceSwearAllegiance),
    AllegianceBreakAllegiance(gameactions::AllegianceBreakAllegiance),
    AllegianceUpdateRequest(gameactions::AllegianceUpdateRequest),
    SocialClearFriends(gameactions::SocialClearFriends),
    CharacterTeleToPKLArena(gameactions::CharacterTeleToPKLArena),
    CharacterTeleToPKArena(gameactions::CharacterTeleToPKArena),
    SocialSetDisplayCharacterTitle(gameactions::SocialSetDisplayCharacterTitle),
    AllegianceQueryAllegianceName(gameactions::AllegianceQueryAllegianceName),
    AllegianceClearAllegianceName(gameactions::AllegianceClearAllegianceName),
    CommunicationTalkDirect(gameactions::CommunicationTalkDirect),
    AllegianceSetAllegianceName(gameactions::AllegianceSetAllegianceName),
    InventoryUseWithTargetEvent(gameactions::InventoryUseWithTargetEvent),
    InventoryUseEvent(gameactions::InventoryUseEvent),
    AllegianceSetAllegianceOfficer(gameactions::AllegianceSetAllegianceOfficer),
    AllegianceSetAllegianceOfficerTitle(gameactions::AllegianceSetAllegianceOfficerTitle),
    AllegianceListAllegianceOfficerTitles(gameactions::AllegianceListAllegianceOfficerTitles),
    AllegianceClearAllegianceOfficerTitles(gameactions::AllegianceClearAllegianceOfficerTitles),
    AllegianceDoAllegianceLockAction(gameactions::AllegianceDoAllegianceLockAction),
    AllegianceSetAllegianceApprovedVassal(gameactions::AllegianceSetAllegianceApprovedVassal),
    AllegianceAllegianceChatGag(gameactions::AllegianceAllegianceChatGag),
    AllegianceDoAllegianceHouseAction(gameactions::AllegianceDoAllegianceHouseAction),
    TrainTrainAttribute2nd(gameactions::TrainTrainAttribute2nd),
    TrainTrainAttribute(gameactions::TrainTrainAttribute),
    TrainTrainSkill(gameactions::TrainTrainSkill),
    TrainTrainSkillAdvancementClass(gameactions::TrainTrainSkillAdvancementClass),
    MagicCastUntargetedSpell(gameactions::MagicCastUntargetedSpell),
    MagicCastTargetedSpell(gameactions::MagicCastTargetedSpell),
    CombatChangeCombatMode(gameactions::CombatChangeCombatMode),
    InventoryStackableMerge(gameactions::InventoryStackableMerge),
    InventoryStackableSplitToContainer(gameactions::InventoryStackableSplitToContainer),
    InventoryStackableSplitTo3D(gameactions::InventoryStackableSplitTo3D),
    CommunicationModifyCharacterSquelch(gameactions::CommunicationModifyCharacterSquelch),
    CommunicationModifyAccountSquelch(gameactions::CommunicationModifyAccountSquelch),
    CommunicationModifyGlobalSquelch(gameactions::CommunicationModifyGlobalSquelch),
    CommunicationTalkDirectByName(gameactions::CommunicationTalkDirectByName),
    VendorBuy(gameactions::VendorBuy),
    VendorSell(gameactions::VendorSell),
    CharacterTeleToLifestone(gameactions::CharacterTeleToLifestone),
    CharacterLoginCompleteNotification(gameactions::CharacterLoginCompleteNotification),
    FellowshipCreate(gameactions::FellowshipCreate),
    FellowshipQuit(gameactions::FellowshipQuit),
    FellowshipDismiss(gameactions::FellowshipDismiss),
    FellowshipRecruit(gameactions::FellowshipRecruit),
    FellowshipUpdateRequest(gameactions::FellowshipUpdateRequest),
    WritingBookAddPage(gameactions::WritingBookAddPage),
    WritingBookModifyPage(gameactions::WritingBookModifyPage),
    WritingBookData(gameactions::WritingBookData),
    WritingBookDeletePage(gameactions::WritingBookDeletePage),
    WritingBookPageData(gameactions::WritingBookPageData),
    WritingSetInscription(gameactions::WritingSetInscription),
    ItemAppraise(gameactions::ItemAppraise),
    InventoryGiveObjectRequest(gameactions::InventoryGiveObjectRequest),
    AdvocateTeleport(gameactions::AdvocateTeleport),
    CharacterAbuseLogRequest(gameactions::CharacterAbuseLogRequest),
    CommunicationAddToChannel(gameactions::CommunicationAddToChannel),
    CommunicationRemoveFromChannel(gameactions::CommunicationRemoveFromChannel),
    CommunicationChannelBroadcast(gameactions::CommunicationChannelBroadcast),
    CommunicationChannelList(gameactions::CommunicationChannelList),
    CommunicationChannelIndex(gameactions::CommunicationChannelIndex),
    InventoryNoLongerViewingContents(gameactions::InventoryNoLongerViewingContents),
    InventoryStackableSplitToWield(gameactions::InventoryStackableSplitToWield),
    CharacterAddShortCut(gameactions::CharacterAddShortCut),
    CharacterRemoveShortCut(gameactions::CharacterRemoveShortCut),
    CharacterCharacterOptionsEvent(Box<gameactions::CharacterCharacterOptionsEvent>),
    MagicRemoveSpell(gameactions::MagicRemoveSpell),
    CombatCancelAttack(gameactions::CombatCancelAttack),
    CombatQueryHealth(gameactions::CombatQueryHealth),
    CharacterQueryAge(gameactions::CharacterQueryAge),
    CharacterQueryBirth(gameactions::CharacterQueryBirth),
    CommunicationEmote(gameactions::CommunicationEmote),
    CommunicationSoulEmote(gameactions::CommunicationSoulEmote),
    CharacterAddSpellFavorite(gameactions::CharacterAddSpellFavorite),
    CharacterRemoveSpellFavorite(gameactions::CharacterRemoveSpellFavorite),
    CharacterRequestPing(gameactions::CharacterRequestPing),
    TradeOpenTradeNegotiations(gameactions::TradeOpenTradeNegotiations),
    TradeCloseTradeNegotiations(gameactions::TradeCloseTradeNegotiations),
    TradeAddToTrade(gameactions::TradeAddToTrade),
    TradeAcceptTrade(gameactions::TradeAcceptTrade),
    TradeDeclineTrade(gameactions::TradeDeclineTrade),
    TradeResetTrade(gameactions::TradeResetTrade),
    CharacterClearPlayerConsentList(gameactions::CharacterClearPlayerConsentList),
    CharacterDisplayPlayerConsentList(gameactions::CharacterDisplayPlayerConsentList),
    CharacterRemoveFromPlayerConsentList(gameactions::CharacterRemoveFromPlayerConsentList),
    CharacterAddPlayerPermission(gameactions::CharacterAddPlayerPermission),
    HouseBuyHouse(gameactions::HouseBuyHouse),
    HouseQueryHouse(gameactions::HouseQueryHouse),
    HouseAbandonHouse(gameactions::HouseAbandonHouse),
    CharacterRemovePlayerPermission(gameactions::CharacterRemovePlayerPermission),
    HouseRentHouse(gameactions::HouseRentHouse),
    CharacterSetDesiredComponentLevel(gameactions::CharacterSetDesiredComponentLevel),
    HouseAddPermanentGuest(gameactions::HouseAddPermanentGuest),
    HouseRemovePermanentGuest(gameactions::HouseRemovePermanentGuest),
    HouseSetOpenHouseStatus(gameactions::HouseSetOpenHouseStatus),
    HouseChangeStoragePermission(gameactions::HouseChangeStoragePermission),
    HouseBootSpecificHouseGuest(gameactions::HouseBootSpecificHouseGuest),
    HouseRemoveAllStoragePermission(gameactions::HouseRemoveAllStoragePermission),
    HouseRequestFullGuestList(gameactions::HouseRequestFullGuestList),
    AllegianceSetMotd(gameactions::AllegianceSetMotd),
    AllegianceQueryMotd(gameactions::AllegianceQueryMotd),
    AllegianceClearMotd(gameactions::AllegianceClearMotd),
    HouseQueryLord(gameactions::HouseQueryLord),
    HouseAddAllStoragePermission(gameactions::HouseAddAllStoragePermission),
    HouseRemoveAllPermanentGuests(gameactions::HouseRemoveAllPermanentGuests),
    HouseBootEveryone(gameactions::HouseBootEveryone),
    HouseTeleToHouse(gameactions::HouseTeleToHouse),
    ItemQueryItemMana(gameactions::ItemQueryItemMana),
    HouseSetHooksVisibility(gameactions::HouseSetHooksVisibility),
    HouseModifyAllegianceGuestPermission(gameactions::HouseModifyAllegianceGuestPermission),
    HouseModifyAllegianceStoragePermission(gameactions::HouseModifyAllegianceStoragePermission),
    GameJoin(gameactions::GameJoin),
    GameQuit(gameactions::GameQuit),
    GameMove(gameactions::GameMove),
    GameMovePass(gameactions::GameMovePass),
    GameStalemate(gameactions::GameStalemate),
    HouseListAvailableHouses(gameactions::HouseListAvailableHouses),
    CharacterConfirmationResponse(gameactions::CharacterConfirmationResponse),
    AllegianceBreakAllegianceBoot(gameactions::AllegianceBreakAllegianceBoot),
    HouseTeleToMansion(gameactions::HouseTeleToMansion),
    CharacterSuicide(gameactions::CharacterSuicide),
    AllegianceAllegianceInfoRequest(gameactions::AllegianceAllegianceInfoRequest),
    InventoryCreateTinkeringTool(gameactions::InventoryCreateTinkeringTool),
    CharacterSpellbookFilterEvent(gameactions::CharacterSpellbookFilterEvent),
    CharacterTeleToMarketplace(gameactions::CharacterTeleToMarketplace),
    CharacterEnterPKLite(gameactions::CharacterEnterPKLite),
    FellowshipAssignNewLeader(gameactions::FellowshipAssignNewLeader),
    FellowshipChangeFellowOpeness(gameactions::FellowshipChangeFellowOpeness),
    AllegianceAllegianceChatBoot(gameactions::AllegianceAllegianceChatBoot),
    AllegianceAddAllegianceBan(gameactions::AllegianceAddAllegianceBan),
    AllegianceRemoveAllegianceBan(gameactions::AllegianceRemoveAllegianceBan),
    AllegianceListAllegianceBans(gameactions::AllegianceListAllegianceBans),
    AllegianceRemoveAllegianceOfficer(gameactions::AllegianceRemoveAllegianceOfficer),
    AllegianceListAllegianceOfficers(gameactions::AllegianceListAllegianceOfficers),
    AllegianceClearAllegianceOfficers(gameactions::AllegianceClearAllegianceOfficers),
    AllegianceRecallAllegianceHometown(gameactions::AllegianceRecallAllegianceHometown),
    AdminQueryPluginListResponse(gameactions::AdminQueryPluginListResponse),
    AdminQueryPluginResponse(gameactions::AdminQueryPluginResponse),
    CharacterFinishBarber(gameactions::CharacterFinishBarber),
    SocialAbandonContract(gameactions::SocialAbandonContract),
    MovementJump(gameactions::MovementJump),
    MovementMoveToState(gameactions::MovementMoveToState),
    MovementDoMovementCommand(gameactions::MovementDoMovementCommand),
    MovementStopMovementCommand(gameactions::MovementStopMovementCommand),
    MovementAutonomyLevel(gameactions::MovementAutonomyLevel),
    MovementAutonomousPosition(gameactions::MovementAutonomousPosition),
    MovementJumpNonAutonomous(gameactions::MovementJumpNonAutonomous),
}

impl GameActionMessage {
    pub fn read(reader: &mut dyn ACReader) -> Result<Self, Box<dyn std::error::Error>> {
        let opcode = read_u32(reader)?;
        let opcode_enum = crate::enums::GameAction::try_from(opcode)
            .map_err(|_| format!("Unknown GameActionMessage opcode: 0x{:04X}", opcode))?;

        match opcode_enum {
            crate::enums::GameAction::CharacterPlayerOptionChangedEvent => Ok(GameActionMessage::CharacterPlayerOptionChangedEvent(gameactions::CharacterPlayerOptionChangedEvent::read(reader)?)),
            crate::enums::GameAction::CombatTargetedMeleeAttack => Ok(GameActionMessage::CombatTargetedMeleeAttack(gameactions::CombatTargetedMeleeAttack::read(reader)?)),
            crate::enums::GameAction::CombatTargetedMissileAttack => Ok(GameActionMessage::CombatTargetedMissileAttack(gameactions::CombatTargetedMissileAttack::read(reader)?)),
            crate::enums::GameAction::CommunicationSetAFKMode => Ok(GameActionMessage::CommunicationSetAFKMode(gameactions::CommunicationSetAFKMode::read(reader)?)),
            crate::enums::GameAction::CommunicationSetAFKMessage => Ok(GameActionMessage::CommunicationSetAFKMessage(gameactions::CommunicationSetAFKMessage::read(reader)?)),
            crate::enums::GameAction::CommunicationTalk => Ok(GameActionMessage::CommunicationTalk(gameactions::CommunicationTalk::read(reader)?)),
            crate::enums::GameAction::SocialRemoveFriend => Ok(GameActionMessage::SocialRemoveFriend(gameactions::SocialRemoveFriend::read(reader)?)),
            crate::enums::GameAction::SocialAddFriend => Ok(GameActionMessage::SocialAddFriend(gameactions::SocialAddFriend::read(reader)?)),
            crate::enums::GameAction::InventoryPutItemInContainer => Ok(GameActionMessage::InventoryPutItemInContainer(gameactions::InventoryPutItemInContainer::read(reader)?)),
            crate::enums::GameAction::InventoryGetAndWieldItem => Ok(GameActionMessage::InventoryGetAndWieldItem(gameactions::InventoryGetAndWieldItem::read(reader)?)),
            crate::enums::GameAction::InventoryDropItem => Ok(GameActionMessage::InventoryDropItem(gameactions::InventoryDropItem::read(reader)?)),
            crate::enums::GameAction::AllegianceSwearAllegiance => Ok(GameActionMessage::AllegianceSwearAllegiance(gameactions::AllegianceSwearAllegiance::read(reader)?)),
            crate::enums::GameAction::AllegianceBreakAllegiance => Ok(GameActionMessage::AllegianceBreakAllegiance(gameactions::AllegianceBreakAllegiance::read(reader)?)),
            crate::enums::GameAction::AllegianceUpdateRequest => Ok(GameActionMessage::AllegianceUpdateRequest(gameactions::AllegianceUpdateRequest::read(reader)?)),
            crate::enums::GameAction::SocialClearFriends => Ok(GameActionMessage::SocialClearFriends(gameactions::SocialClearFriends::read(reader)?)),
            crate::enums::GameAction::CharacterTeleToPKLArena => Ok(GameActionMessage::CharacterTeleToPKLArena(gameactions::CharacterTeleToPKLArena::read(reader)?)),
            crate::enums::GameAction::CharacterTeleToPKArena => Ok(GameActionMessage::CharacterTeleToPKArena(gameactions::CharacterTeleToPKArena::read(reader)?)),
            crate::enums::GameAction::SocialSetDisplayCharacterTitle => Ok(GameActionMessage::SocialSetDisplayCharacterTitle(gameactions::SocialSetDisplayCharacterTitle::read(reader)?)),
            crate::enums::GameAction::AllegianceQueryAllegianceName => Ok(GameActionMessage::AllegianceQueryAllegianceName(gameactions::AllegianceQueryAllegianceName::read(reader)?)),
            crate::enums::GameAction::AllegianceClearAllegianceName => Ok(GameActionMessage::AllegianceClearAllegianceName(gameactions::AllegianceClearAllegianceName::read(reader)?)),
            crate::enums::GameAction::CommunicationTalkDirect => Ok(GameActionMessage::CommunicationTalkDirect(gameactions::CommunicationTalkDirect::read(reader)?)),
            crate::enums::GameAction::AllegianceSetAllegianceName => Ok(GameActionMessage::AllegianceSetAllegianceName(gameactions::AllegianceSetAllegianceName::read(reader)?)),
            crate::enums::GameAction::InventoryUseWithTargetEvent => Ok(GameActionMessage::InventoryUseWithTargetEvent(gameactions::InventoryUseWithTargetEvent::read(reader)?)),
            crate::enums::GameAction::InventoryUseEvent => Ok(GameActionMessage::InventoryUseEvent(gameactions::InventoryUseEvent::read(reader)?)),
            crate::enums::GameAction::AllegianceSetAllegianceOfficer => Ok(GameActionMessage::AllegianceSetAllegianceOfficer(gameactions::AllegianceSetAllegianceOfficer::read(reader)?)),
            crate::enums::GameAction::AllegianceSetAllegianceOfficerTitle => Ok(GameActionMessage::AllegianceSetAllegianceOfficerTitle(gameactions::AllegianceSetAllegianceOfficerTitle::read(reader)?)),
            crate::enums::GameAction::AllegianceListAllegianceOfficerTitles => Ok(GameActionMessage::AllegianceListAllegianceOfficerTitles(gameactions::AllegianceListAllegianceOfficerTitles::read(reader)?)),
            crate::enums::GameAction::AllegianceClearAllegianceOfficerTitles => Ok(GameActionMessage::AllegianceClearAllegianceOfficerTitles(gameactions::AllegianceClearAllegianceOfficerTitles::read(reader)?)),
            crate::enums::GameAction::AllegianceDoAllegianceLockAction => Ok(GameActionMessage::AllegianceDoAllegianceLockAction(gameactions::AllegianceDoAllegianceLockAction::read(reader)?)),
            crate::enums::GameAction::AllegianceSetAllegianceApprovedVassal => Ok(GameActionMessage::AllegianceSetAllegianceApprovedVassal(gameactions::AllegianceSetAllegianceApprovedVassal::read(reader)?)),
            crate::enums::GameAction::AllegianceAllegianceChatGag => Ok(GameActionMessage::AllegianceAllegianceChatGag(gameactions::AllegianceAllegianceChatGag::read(reader)?)),
            crate::enums::GameAction::AllegianceDoAllegianceHouseAction => Ok(GameActionMessage::AllegianceDoAllegianceHouseAction(gameactions::AllegianceDoAllegianceHouseAction::read(reader)?)),
            crate::enums::GameAction::TrainTrainAttribute2nd => Ok(GameActionMessage::TrainTrainAttribute2nd(gameactions::TrainTrainAttribute2nd::read(reader)?)),
            crate::enums::GameAction::TrainTrainAttribute => Ok(GameActionMessage::TrainTrainAttribute(gameactions::TrainTrainAttribute::read(reader)?)),
            crate::enums::GameAction::TrainTrainSkill => Ok(GameActionMessage::TrainTrainSkill(gameactions::TrainTrainSkill::read(reader)?)),
            crate::enums::GameAction::TrainTrainSkillAdvancementClass => Ok(GameActionMessage::TrainTrainSkillAdvancementClass(gameactions::TrainTrainSkillAdvancementClass::read(reader)?)),
            crate::enums::GameAction::MagicCastUntargetedSpell => Ok(GameActionMessage::MagicCastUntargetedSpell(gameactions::MagicCastUntargetedSpell::read(reader)?)),
            crate::enums::GameAction::MagicCastTargetedSpell => Ok(GameActionMessage::MagicCastTargetedSpell(gameactions::MagicCastTargetedSpell::read(reader)?)),
            crate::enums::GameAction::CombatChangeCombatMode => Ok(GameActionMessage::CombatChangeCombatMode(gameactions::CombatChangeCombatMode::read(reader)?)),
            crate::enums::GameAction::InventoryStackableMerge => Ok(GameActionMessage::InventoryStackableMerge(gameactions::InventoryStackableMerge::read(reader)?)),
            crate::enums::GameAction::InventoryStackableSplitToContainer => Ok(GameActionMessage::InventoryStackableSplitToContainer(gameactions::InventoryStackableSplitToContainer::read(reader)?)),
            crate::enums::GameAction::InventoryStackableSplitTo3D => Ok(GameActionMessage::InventoryStackableSplitTo3D(gameactions::InventoryStackableSplitTo3D::read(reader)?)),
            crate::enums::GameAction::CommunicationModifyCharacterSquelch => Ok(GameActionMessage::CommunicationModifyCharacterSquelch(gameactions::CommunicationModifyCharacterSquelch::read(reader)?)),
            crate::enums::GameAction::CommunicationModifyAccountSquelch => Ok(GameActionMessage::CommunicationModifyAccountSquelch(gameactions::CommunicationModifyAccountSquelch::read(reader)?)),
            crate::enums::GameAction::CommunicationModifyGlobalSquelch => Ok(GameActionMessage::CommunicationModifyGlobalSquelch(gameactions::CommunicationModifyGlobalSquelch::read(reader)?)),
            crate::enums::GameAction::CommunicationTalkDirectByName => Ok(GameActionMessage::CommunicationTalkDirectByName(gameactions::CommunicationTalkDirectByName::read(reader)?)),
            crate::enums::GameAction::VendorBuy => Ok(GameActionMessage::VendorBuy(gameactions::VendorBuy::read(reader)?)),
            crate::enums::GameAction::VendorSell => Ok(GameActionMessage::VendorSell(gameactions::VendorSell::read(reader)?)),
            crate::enums::GameAction::CharacterTeleToLifestone => Ok(GameActionMessage::CharacterTeleToLifestone(gameactions::CharacterTeleToLifestone::read(reader)?)),
            crate::enums::GameAction::CharacterLoginCompleteNotification => Ok(GameActionMessage::CharacterLoginCompleteNotification(gameactions::CharacterLoginCompleteNotification::read(reader)?)),
            crate::enums::GameAction::FellowshipCreate => Ok(GameActionMessage::FellowshipCreate(gameactions::FellowshipCreate::read(reader)?)),
            crate::enums::GameAction::FellowshipQuit => Ok(GameActionMessage::FellowshipQuit(gameactions::FellowshipQuit::read(reader)?)),
            crate::enums::GameAction::FellowshipDismiss => Ok(GameActionMessage::FellowshipDismiss(gameactions::FellowshipDismiss::read(reader)?)),
            crate::enums::GameAction::FellowshipRecruit => Ok(GameActionMessage::FellowshipRecruit(gameactions::FellowshipRecruit::read(reader)?)),
            crate::enums::GameAction::FellowshipUpdateRequest => Ok(GameActionMessage::FellowshipUpdateRequest(gameactions::FellowshipUpdateRequest::read(reader)?)),
            crate::enums::GameAction::WritingBookAddPage => Ok(GameActionMessage::WritingBookAddPage(gameactions::WritingBookAddPage::read(reader)?)),
            crate::enums::GameAction::WritingBookModifyPage => Ok(GameActionMessage::WritingBookModifyPage(gameactions::WritingBookModifyPage::read(reader)?)),
            crate::enums::GameAction::WritingBookData => Ok(GameActionMessage::WritingBookData(gameactions::WritingBookData::read(reader)?)),
            crate::enums::GameAction::WritingBookDeletePage => Ok(GameActionMessage::WritingBookDeletePage(gameactions::WritingBookDeletePage::read(reader)?)),
            crate::enums::GameAction::WritingBookPageData => Ok(GameActionMessage::WritingBookPageData(gameactions::WritingBookPageData::read(reader)?)),
            crate::enums::GameAction::WritingSetInscription => Ok(GameActionMessage::WritingSetInscription(gameactions::WritingSetInscription::read(reader)?)),
            crate::enums::GameAction::ItemAppraise => Ok(GameActionMessage::ItemAppraise(gameactions::ItemAppraise::read(reader)?)),
            crate::enums::GameAction::InventoryGiveObjectRequest => Ok(GameActionMessage::InventoryGiveObjectRequest(gameactions::InventoryGiveObjectRequest::read(reader)?)),
            crate::enums::GameAction::AdvocateTeleport => Ok(GameActionMessage::AdvocateTeleport(gameactions::AdvocateTeleport::read(reader)?)),
            crate::enums::GameAction::CharacterAbuseLogRequest => Ok(GameActionMessage::CharacterAbuseLogRequest(gameactions::CharacterAbuseLogRequest::read(reader)?)),
            crate::enums::GameAction::CommunicationAddToChannel => Ok(GameActionMessage::CommunicationAddToChannel(gameactions::CommunicationAddToChannel::read(reader)?)),
            crate::enums::GameAction::CommunicationRemoveFromChannel => Ok(GameActionMessage::CommunicationRemoveFromChannel(gameactions::CommunicationRemoveFromChannel::read(reader)?)),
            crate::enums::GameAction::CommunicationChannelBroadcast => Ok(GameActionMessage::CommunicationChannelBroadcast(gameactions::CommunicationChannelBroadcast::read(reader)?)),
            crate::enums::GameAction::CommunicationChannelList => Ok(GameActionMessage::CommunicationChannelList(gameactions::CommunicationChannelList::read(reader)?)),
            crate::enums::GameAction::CommunicationChannelIndex => Ok(GameActionMessage::CommunicationChannelIndex(gameactions::CommunicationChannelIndex::read(reader)?)),
            crate::enums::GameAction::InventoryNoLongerViewingContents => Ok(GameActionMessage::InventoryNoLongerViewingContents(gameactions::InventoryNoLongerViewingContents::read(reader)?)),
            crate::enums::GameAction::InventoryStackableSplitToWield => Ok(GameActionMessage::InventoryStackableSplitToWield(gameactions::InventoryStackableSplitToWield::read(reader)?)),
            crate::enums::GameAction::CharacterAddShortCut => Ok(GameActionMessage::CharacterAddShortCut(gameactions::CharacterAddShortCut::read(reader)?)),
            crate::enums::GameAction::CharacterRemoveShortCut => Ok(GameActionMessage::CharacterRemoveShortCut(gameactions::CharacterRemoveShortCut::read(reader)?)),
            crate::enums::GameAction::CharacterCharacterOptionsEvent => Ok(GameActionMessage::CharacterCharacterOptionsEvent(Box::new(gameactions::CharacterCharacterOptionsEvent::read(reader)?))),
            crate::enums::GameAction::MagicRemoveSpell => Ok(GameActionMessage::MagicRemoveSpell(gameactions::MagicRemoveSpell::read(reader)?)),
            crate::enums::GameAction::CombatCancelAttack => Ok(GameActionMessage::CombatCancelAttack(gameactions::CombatCancelAttack::read(reader)?)),
            crate::enums::GameAction::CombatQueryHealth => Ok(GameActionMessage::CombatQueryHealth(gameactions::CombatQueryHealth::read(reader)?)),
            crate::enums::GameAction::CharacterQueryAge => Ok(GameActionMessage::CharacterQueryAge(gameactions::CharacterQueryAge::read(reader)?)),
            crate::enums::GameAction::CharacterQueryBirth => Ok(GameActionMessage::CharacterQueryBirth(gameactions::CharacterQueryBirth::read(reader)?)),
            crate::enums::GameAction::CommunicationEmote => Ok(GameActionMessage::CommunicationEmote(gameactions::CommunicationEmote::read(reader)?)),
            crate::enums::GameAction::CommunicationSoulEmote => Ok(GameActionMessage::CommunicationSoulEmote(gameactions::CommunicationSoulEmote::read(reader)?)),
            crate::enums::GameAction::CharacterAddSpellFavorite => Ok(GameActionMessage::CharacterAddSpellFavorite(gameactions::CharacterAddSpellFavorite::read(reader)?)),
            crate::enums::GameAction::CharacterRemoveSpellFavorite => Ok(GameActionMessage::CharacterRemoveSpellFavorite(gameactions::CharacterRemoveSpellFavorite::read(reader)?)),
            crate::enums::GameAction::CharacterRequestPing => Ok(GameActionMessage::CharacterRequestPing(gameactions::CharacterRequestPing::read(reader)?)),
            crate::enums::GameAction::TradeOpenTradeNegotiations => Ok(GameActionMessage::TradeOpenTradeNegotiations(gameactions::TradeOpenTradeNegotiations::read(reader)?)),
            crate::enums::GameAction::TradeCloseTradeNegotiations => Ok(GameActionMessage::TradeCloseTradeNegotiations(gameactions::TradeCloseTradeNegotiations::read(reader)?)),
            crate::enums::GameAction::TradeAddToTrade => Ok(GameActionMessage::TradeAddToTrade(gameactions::TradeAddToTrade::read(reader)?)),
            crate::enums::GameAction::TradeAcceptTrade => Ok(GameActionMessage::TradeAcceptTrade(gameactions::TradeAcceptTrade::read(reader)?)),
            crate::enums::GameAction::TradeDeclineTrade => Ok(GameActionMessage::TradeDeclineTrade(gameactions::TradeDeclineTrade::read(reader)?)),
            crate::enums::GameAction::TradeResetTrade => Ok(GameActionMessage::TradeResetTrade(gameactions::TradeResetTrade::read(reader)?)),
            crate::enums::GameAction::CharacterClearPlayerConsentList => Ok(GameActionMessage::CharacterClearPlayerConsentList(gameactions::CharacterClearPlayerConsentList::read(reader)?)),
            crate::enums::GameAction::CharacterDisplayPlayerConsentList => Ok(GameActionMessage::CharacterDisplayPlayerConsentList(gameactions::CharacterDisplayPlayerConsentList::read(reader)?)),
            crate::enums::GameAction::CharacterRemoveFromPlayerConsentList => Ok(GameActionMessage::CharacterRemoveFromPlayerConsentList(gameactions::CharacterRemoveFromPlayerConsentList::read(reader)?)),
            crate::enums::GameAction::CharacterAddPlayerPermission => Ok(GameActionMessage::CharacterAddPlayerPermission(gameactions::CharacterAddPlayerPermission::read(reader)?)),
            crate::enums::GameAction::HouseBuyHouse => Ok(GameActionMessage::HouseBuyHouse(gameactions::HouseBuyHouse::read(reader)?)),
            crate::enums::GameAction::HouseQueryHouse => Ok(GameActionMessage::HouseQueryHouse(gameactions::HouseQueryHouse::read(reader)?)),
            crate::enums::GameAction::HouseAbandonHouse => Ok(GameActionMessage::HouseAbandonHouse(gameactions::HouseAbandonHouse::read(reader)?)),
            crate::enums::GameAction::CharacterRemovePlayerPermission => Ok(GameActionMessage::CharacterRemovePlayerPermission(gameactions::CharacterRemovePlayerPermission::read(reader)?)),
            crate::enums::GameAction::HouseRentHouse => Ok(GameActionMessage::HouseRentHouse(gameactions::HouseRentHouse::read(reader)?)),
            crate::enums::GameAction::CharacterSetDesiredComponentLevel => Ok(GameActionMessage::CharacterSetDesiredComponentLevel(gameactions::CharacterSetDesiredComponentLevel::read(reader)?)),
            crate::enums::GameAction::HouseAddPermanentGuest => Ok(GameActionMessage::HouseAddPermanentGuest(gameactions::HouseAddPermanentGuest::read(reader)?)),
            crate::enums::GameAction::HouseRemovePermanentGuest => Ok(GameActionMessage::HouseRemovePermanentGuest(gameactions::HouseRemovePermanentGuest::read(reader)?)),
            crate::enums::GameAction::HouseSetOpenHouseStatus => Ok(GameActionMessage::HouseSetOpenHouseStatus(gameactions::HouseSetOpenHouseStatus::read(reader)?)),
            crate::enums::GameAction::HouseChangeStoragePermission => Ok(GameActionMessage::HouseChangeStoragePermission(gameactions::HouseChangeStoragePermission::read(reader)?)),
            crate::enums::GameAction::HouseBootSpecificHouseGuest => Ok(GameActionMessage::HouseBootSpecificHouseGuest(gameactions::HouseBootSpecificHouseGuest::read(reader)?)),
            crate::enums::GameAction::HouseRemoveAllStoragePermission => Ok(GameActionMessage::HouseRemoveAllStoragePermission(gameactions::HouseRemoveAllStoragePermission::read(reader)?)),
            crate::enums::GameAction::HouseRequestFullGuestList => Ok(GameActionMessage::HouseRequestFullGuestList(gameactions::HouseRequestFullGuestList::read(reader)?)),
            crate::enums::GameAction::AllegianceSetMotd => Ok(GameActionMessage::AllegianceSetMotd(gameactions::AllegianceSetMotd::read(reader)?)),
            crate::enums::GameAction::AllegianceQueryMotd => Ok(GameActionMessage::AllegianceQueryMotd(gameactions::AllegianceQueryMotd::read(reader)?)),
            crate::enums::GameAction::AllegianceClearMotd => Ok(GameActionMessage::AllegianceClearMotd(gameactions::AllegianceClearMotd::read(reader)?)),
            crate::enums::GameAction::HouseQueryLord => Ok(GameActionMessage::HouseQueryLord(gameactions::HouseQueryLord::read(reader)?)),
            crate::enums::GameAction::HouseAddAllStoragePermission => Ok(GameActionMessage::HouseAddAllStoragePermission(gameactions::HouseAddAllStoragePermission::read(reader)?)),
            crate::enums::GameAction::HouseRemoveAllPermanentGuests => Ok(GameActionMessage::HouseRemoveAllPermanentGuests(gameactions::HouseRemoveAllPermanentGuests::read(reader)?)),
            crate::enums::GameAction::HouseBootEveryone => Ok(GameActionMessage::HouseBootEveryone(gameactions::HouseBootEveryone::read(reader)?)),
            crate::enums::GameAction::HouseTeleToHouse => Ok(GameActionMessage::HouseTeleToHouse(gameactions::HouseTeleToHouse::read(reader)?)),
            crate::enums::GameAction::ItemQueryItemMana => Ok(GameActionMessage::ItemQueryItemMana(gameactions::ItemQueryItemMana::read(reader)?)),
            crate::enums::GameAction::HouseSetHooksVisibility => Ok(GameActionMessage::HouseSetHooksVisibility(gameactions::HouseSetHooksVisibility::read(reader)?)),
            crate::enums::GameAction::HouseModifyAllegianceGuestPermission => Ok(GameActionMessage::HouseModifyAllegianceGuestPermission(gameactions::HouseModifyAllegianceGuestPermission::read(reader)?)),
            crate::enums::GameAction::HouseModifyAllegianceStoragePermission => Ok(GameActionMessage::HouseModifyAllegianceStoragePermission(gameactions::HouseModifyAllegianceStoragePermission::read(reader)?)),
            crate::enums::GameAction::GameJoin => Ok(GameActionMessage::GameJoin(gameactions::GameJoin::read(reader)?)),
            crate::enums::GameAction::GameQuit => Ok(GameActionMessage::GameQuit(gameactions::GameQuit::read(reader)?)),
            crate::enums::GameAction::GameMove => Ok(GameActionMessage::GameMove(gameactions::GameMove::read(reader)?)),
            crate::enums::GameAction::GameMovePass => Ok(GameActionMessage::GameMovePass(gameactions::GameMovePass::read(reader)?)),
            crate::enums::GameAction::GameStalemate => Ok(GameActionMessage::GameStalemate(gameactions::GameStalemate::read(reader)?)),
            crate::enums::GameAction::HouseListAvailableHouses => Ok(GameActionMessage::HouseListAvailableHouses(gameactions::HouseListAvailableHouses::read(reader)?)),
            crate::enums::GameAction::CharacterConfirmationResponse => Ok(GameActionMessage::CharacterConfirmationResponse(gameactions::CharacterConfirmationResponse::read(reader)?)),
            crate::enums::GameAction::AllegianceBreakAllegianceBoot => Ok(GameActionMessage::AllegianceBreakAllegianceBoot(gameactions::AllegianceBreakAllegianceBoot::read(reader)?)),
            crate::enums::GameAction::HouseTeleToMansion => Ok(GameActionMessage::HouseTeleToMansion(gameactions::HouseTeleToMansion::read(reader)?)),
            crate::enums::GameAction::CharacterSuicide => Ok(GameActionMessage::CharacterSuicide(gameactions::CharacterSuicide::read(reader)?)),
            crate::enums::GameAction::AllegianceAllegianceInfoRequest => Ok(GameActionMessage::AllegianceAllegianceInfoRequest(gameactions::AllegianceAllegianceInfoRequest::read(reader)?)),
            crate::enums::GameAction::InventoryCreateTinkeringTool => Ok(GameActionMessage::InventoryCreateTinkeringTool(gameactions::InventoryCreateTinkeringTool::read(reader)?)),
            crate::enums::GameAction::CharacterSpellbookFilterEvent => Ok(GameActionMessage::CharacterSpellbookFilterEvent(gameactions::CharacterSpellbookFilterEvent::read(reader)?)),
            crate::enums::GameAction::CharacterTeleToMarketplace => Ok(GameActionMessage::CharacterTeleToMarketplace(gameactions::CharacterTeleToMarketplace::read(reader)?)),
            crate::enums::GameAction::CharacterEnterPKLite => Ok(GameActionMessage::CharacterEnterPKLite(gameactions::CharacterEnterPKLite::read(reader)?)),
            crate::enums::GameAction::FellowshipAssignNewLeader => Ok(GameActionMessage::FellowshipAssignNewLeader(gameactions::FellowshipAssignNewLeader::read(reader)?)),
            crate::enums::GameAction::FellowshipChangeFellowOpeness => Ok(GameActionMessage::FellowshipChangeFellowOpeness(gameactions::FellowshipChangeFellowOpeness::read(reader)?)),
            crate::enums::GameAction::AllegianceAllegianceChatBoot => Ok(GameActionMessage::AllegianceAllegianceChatBoot(gameactions::AllegianceAllegianceChatBoot::read(reader)?)),
            crate::enums::GameAction::AllegianceAddAllegianceBan => Ok(GameActionMessage::AllegianceAddAllegianceBan(gameactions::AllegianceAddAllegianceBan::read(reader)?)),
            crate::enums::GameAction::AllegianceRemoveAllegianceBan => Ok(GameActionMessage::AllegianceRemoveAllegianceBan(gameactions::AllegianceRemoveAllegianceBan::read(reader)?)),
            crate::enums::GameAction::AllegianceListAllegianceBans => Ok(GameActionMessage::AllegianceListAllegianceBans(gameactions::AllegianceListAllegianceBans::read(reader)?)),
            crate::enums::GameAction::AllegianceRemoveAllegianceOfficer => Ok(GameActionMessage::AllegianceRemoveAllegianceOfficer(gameactions::AllegianceRemoveAllegianceOfficer::read(reader)?)),
            crate::enums::GameAction::AllegianceListAllegianceOfficers => Ok(GameActionMessage::AllegianceListAllegianceOfficers(gameactions::AllegianceListAllegianceOfficers::read(reader)?)),
            crate::enums::GameAction::AllegianceClearAllegianceOfficers => Ok(GameActionMessage::AllegianceClearAllegianceOfficers(gameactions::AllegianceClearAllegianceOfficers::read(reader)?)),
            crate::enums::GameAction::AllegianceRecallAllegianceHometown => Ok(GameActionMessage::AllegianceRecallAllegianceHometown(gameactions::AllegianceRecallAllegianceHometown::read(reader)?)),
            crate::enums::GameAction::AdminQueryPluginListResponse => Ok(GameActionMessage::AdminQueryPluginListResponse(gameactions::AdminQueryPluginListResponse::read(reader)?)),
            crate::enums::GameAction::AdminQueryPluginResponse => Ok(GameActionMessage::AdminQueryPluginResponse(gameactions::AdminQueryPluginResponse::read(reader)?)),
            crate::enums::GameAction::CharacterFinishBarber => Ok(GameActionMessage::CharacterFinishBarber(gameactions::CharacterFinishBarber::read(reader)?)),
            crate::enums::GameAction::SocialAbandonContract => Ok(GameActionMessage::SocialAbandonContract(gameactions::SocialAbandonContract::read(reader)?)),
            crate::enums::GameAction::MovementJump => Ok(GameActionMessage::MovementJump(gameactions::MovementJump::read(reader)?)),
            crate::enums::GameAction::MovementMoveToState => Ok(GameActionMessage::MovementMoveToState(gameactions::MovementMoveToState::read(reader)?)),
            crate::enums::GameAction::MovementDoMovementCommand => Ok(GameActionMessage::MovementDoMovementCommand(gameactions::MovementDoMovementCommand::read(reader)?)),
            crate::enums::GameAction::MovementStopMovementCommand => Ok(GameActionMessage::MovementStopMovementCommand(gameactions::MovementStopMovementCommand::read(reader)?)),
            crate::enums::GameAction::MovementAutonomyLevel => Ok(GameActionMessage::MovementAutonomyLevel(gameactions::MovementAutonomyLevel::read(reader)?)),
            crate::enums::GameAction::MovementAutonomousPosition => Ok(GameActionMessage::MovementAutonomousPosition(gameactions::MovementAutonomousPosition::read(reader)?)),
            crate::enums::GameAction::MovementJumpNonAutonomous => Ok(GameActionMessage::MovementJumpNonAutonomous(gameactions::MovementJumpNonAutonomous::read(reader)?)),
        }
    }

    pub fn queue(&self) -> Option<MessageQueue> {
        match self {
            GameActionMessage::CharacterPlayerOptionChangedEvent(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CombatTargetedMeleeAttack(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CombatTargetedMissileAttack(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationSetAFKMode(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationSetAFKMessage(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationTalk(_) => Some(MessageQueue::Weenie),
            GameActionMessage::SocialRemoveFriend(_) => Some(MessageQueue::Weenie),
            GameActionMessage::SocialAddFriend(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryPutItemInContainer(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryGetAndWieldItem(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryDropItem(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceSwearAllegiance(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceBreakAllegiance(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceUpdateRequest(_) => Some(MessageQueue::Weenie),
            GameActionMessage::SocialClearFriends(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterTeleToPKLArena(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterTeleToPKArena(_) => Some(MessageQueue::Weenie),
            GameActionMessage::SocialSetDisplayCharacterTitle(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceQueryAllegianceName(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceClearAllegianceName(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationTalkDirect(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceSetAllegianceName(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryUseWithTargetEvent(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryUseEvent(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceSetAllegianceOfficer(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceSetAllegianceOfficerTitle(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceListAllegianceOfficerTitles(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceClearAllegianceOfficerTitles(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceDoAllegianceLockAction(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceSetAllegianceApprovedVassal(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceAllegianceChatGag(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceDoAllegianceHouseAction(_) => Some(MessageQueue::Weenie),
            GameActionMessage::TrainTrainAttribute2nd(_) => Some(MessageQueue::Weenie),
            GameActionMessage::TrainTrainAttribute(_) => Some(MessageQueue::Weenie),
            GameActionMessage::TrainTrainSkill(_) => Some(MessageQueue::Weenie),
            GameActionMessage::TrainTrainSkillAdvancementClass(_) => Some(MessageQueue::Weenie),
            GameActionMessage::MagicCastUntargetedSpell(_) => Some(MessageQueue::Weenie),
            GameActionMessage::MagicCastTargetedSpell(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CombatChangeCombatMode(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryStackableMerge(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryStackableSplitToContainer(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryStackableSplitTo3D(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationModifyCharacterSquelch(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationModifyAccountSquelch(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationModifyGlobalSquelch(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationTalkDirectByName(_) => Some(MessageQueue::Weenie),
            GameActionMessage::VendorBuy(_) => Some(MessageQueue::Weenie),
            GameActionMessage::VendorSell(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterTeleToLifestone(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterLoginCompleteNotification(_) => Some(MessageQueue::Weenie),
            GameActionMessage::FellowshipCreate(_) => Some(MessageQueue::Weenie),
            GameActionMessage::FellowshipQuit(_) => Some(MessageQueue::Weenie),
            GameActionMessage::FellowshipDismiss(_) => Some(MessageQueue::Weenie),
            GameActionMessage::FellowshipRecruit(_) => Some(MessageQueue::Weenie),
            GameActionMessage::FellowshipUpdateRequest(_) => Some(MessageQueue::Weenie),
            GameActionMessage::WritingBookAddPage(_) => Some(MessageQueue::Weenie),
            GameActionMessage::WritingBookModifyPage(_) => Some(MessageQueue::Weenie),
            GameActionMessage::WritingBookData(_) => Some(MessageQueue::Weenie),
            GameActionMessage::WritingBookDeletePage(_) => Some(MessageQueue::Weenie),
            GameActionMessage::WritingBookPageData(_) => Some(MessageQueue::Weenie),
            GameActionMessage::WritingSetInscription(_) => Some(MessageQueue::Weenie),
            GameActionMessage::ItemAppraise(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryGiveObjectRequest(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AdvocateTeleport(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterAbuseLogRequest(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationAddToChannel(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationRemoveFromChannel(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationChannelBroadcast(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationChannelList(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationChannelIndex(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryNoLongerViewingContents(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryStackableSplitToWield(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterAddShortCut(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterRemoveShortCut(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterCharacterOptionsEvent(_) => Some(MessageQueue::Weenie),
            GameActionMessage::MagicRemoveSpell(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CombatCancelAttack(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CombatQueryHealth(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterQueryAge(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterQueryBirth(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationEmote(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CommunicationSoulEmote(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterAddSpellFavorite(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterRemoveSpellFavorite(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterRequestPing(_) => Some(MessageQueue::Weenie),
            GameActionMessage::TradeOpenTradeNegotiations(_) => Some(MessageQueue::Weenie),
            GameActionMessage::TradeCloseTradeNegotiations(_) => Some(MessageQueue::Weenie),
            GameActionMessage::TradeAddToTrade(_) => Some(MessageQueue::Weenie),
            GameActionMessage::TradeAcceptTrade(_) => Some(MessageQueue::Weenie),
            GameActionMessage::TradeDeclineTrade(_) => Some(MessageQueue::Weenie),
            GameActionMessage::TradeResetTrade(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterClearPlayerConsentList(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterDisplayPlayerConsentList(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterRemoveFromPlayerConsentList(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterAddPlayerPermission(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseBuyHouse(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseQueryHouse(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseAbandonHouse(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterRemovePlayerPermission(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseRentHouse(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterSetDesiredComponentLevel(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseAddPermanentGuest(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseRemovePermanentGuest(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseSetOpenHouseStatus(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseChangeStoragePermission(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseBootSpecificHouseGuest(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseRemoveAllStoragePermission(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseRequestFullGuestList(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceSetMotd(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceQueryMotd(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceClearMotd(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseQueryLord(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseAddAllStoragePermission(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseRemoveAllPermanentGuests(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseBootEveryone(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseTeleToHouse(_) => Some(MessageQueue::Weenie),
            GameActionMessage::ItemQueryItemMana(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseSetHooksVisibility(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseModifyAllegianceGuestPermission(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseModifyAllegianceStoragePermission(_) => Some(MessageQueue::Weenie),
            GameActionMessage::GameJoin(_) => Some(MessageQueue::Weenie),
            GameActionMessage::GameQuit(_) => Some(MessageQueue::Weenie),
            GameActionMessage::GameMove(_) => Some(MessageQueue::Weenie),
            GameActionMessage::GameMovePass(_) => Some(MessageQueue::Weenie),
            GameActionMessage::GameStalemate(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseListAvailableHouses(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterConfirmationResponse(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceBreakAllegianceBoot(_) => Some(MessageQueue::Weenie),
            GameActionMessage::HouseTeleToMansion(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterSuicide(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceAllegianceInfoRequest(_) => Some(MessageQueue::Weenie),
            GameActionMessage::InventoryCreateTinkeringTool(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterSpellbookFilterEvent(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterTeleToMarketplace(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterEnterPKLite(_) => Some(MessageQueue::Weenie),
            GameActionMessage::FellowshipAssignNewLeader(_) => Some(MessageQueue::Weenie),
            GameActionMessage::FellowshipChangeFellowOpeness(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceAllegianceChatBoot(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceAddAllegianceBan(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceRemoveAllegianceBan(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceListAllegianceBans(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceRemoveAllegianceOfficer(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceListAllegianceOfficers(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceClearAllegianceOfficers(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AllegianceRecallAllegianceHometown(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AdminQueryPluginListResponse(_) => Some(MessageQueue::Weenie),
            GameActionMessage::AdminQueryPluginResponse(_) => Some(MessageQueue::Weenie),
            GameActionMessage::CharacterFinishBarber(_) => Some(MessageQueue::Weenie),
            GameActionMessage::SocialAbandonContract(_) => Some(MessageQueue::Weenie),
            GameActionMessage::MovementJump(_) => Some(MessageQueue::Weenie),
            GameActionMessage::MovementMoveToState(_) => Some(MessageQueue::Weenie),
            GameActionMessage::MovementDoMovementCommand(_) => Some(MessageQueue::Weenie),
            GameActionMessage::MovementStopMovementCommand(_) => Some(MessageQueue::Weenie),
            GameActionMessage::MovementAutonomyLevel(_) => Some(MessageQueue::Weenie),
            GameActionMessage::MovementAutonomousPosition(_) => Some(MessageQueue::Weenie),
            GameActionMessage::MovementJumpNonAutonomous(_) => Some(MessageQueue::Weenie),
        }
    }
}

/// GameEventMessage enum with message data
#[derive(Debug, Serialize, Deserialize)]
pub enum GameEventMessage {
    AllegianceAllegianceUpdateAborted(gameevents::AllegianceAllegianceUpdateAborted),
    CommunicationPopUpString(gameevents::CommunicationPopUpString),
    LoginPlayerDescription(Box<gameevents::LoginPlayerDescription>),
    AllegianceAllegianceUpdate(gameevents::AllegianceAllegianceUpdate),
    SocialFriendsUpdate(gameevents::SocialFriendsUpdate),
    ItemServerSaysContainId(gameevents::ItemServerSaysContainId),
    ItemWearItem(gameevents::ItemWearItem),
    SocialCharacterTitleTable(gameevents::SocialCharacterTitleTable),
    SocialAddOrSetCharacterTitle(gameevents::SocialAddOrSetCharacterTitle),
    ItemStopViewingObjectContents(gameevents::ItemStopViewingObjectContents),
    VendorVendorInfo(gameevents::VendorVendorInfo),
    CharacterStartBarber(gameevents::CharacterStartBarber),
    FellowshipQuit(gameevents::FellowshipQuit),
    FellowshipDismiss(gameevents::FellowshipDismiss),
    WritingBookOpen(gameevents::WritingBookOpen),
    WritingBookAddPageResponse(gameevents::WritingBookAddPageResponse),
    WritingBookDeletePageResponse(gameevents::WritingBookDeletePageResponse),
    WritingBookPageDataResponse(gameevents::WritingBookPageDataResponse),
    ItemGetInscriptionResponse(gameevents::ItemGetInscriptionResponse),
    ItemSetAppraiseInfo(Box<gameevents::ItemSetAppraiseInfo>),
    CommunicationChannelBroadcast(gameevents::CommunicationChannelBroadcast),
    CommunicationChannelList(gameevents::CommunicationChannelList),
    CommunicationChannelIndex(gameevents::CommunicationChannelIndex),
    ItemOnViewContents(gameevents::ItemOnViewContents),
    ItemServerSaysMoveItem(gameevents::ItemServerSaysMoveItem),
    CombatHandleAttackDoneEvent(gameevents::CombatHandleAttackDoneEvent),
    MagicRemoveSpell(gameevents::MagicRemoveSpell),
    CombatHandleVictimNotificationEventSelf(gameevents::CombatHandleVictimNotificationEventSelf),
    CombatHandleVictimNotificationEventOther(gameevents::CombatHandleVictimNotificationEventOther),
    CombatHandleAttackerNotificationEvent(gameevents::CombatHandleAttackerNotificationEvent),
    CombatHandleDefenderNotificationEvent(gameevents::CombatHandleDefenderNotificationEvent),
    CombatHandleEvasionAttackerNotificationEvent(gameevents::CombatHandleEvasionAttackerNotificationEvent),
    CombatHandleEvasionDefenderNotificationEvent(gameevents::CombatHandleEvasionDefenderNotificationEvent),
    CombatHandleCommenceAttackEvent(gameevents::CombatHandleCommenceAttackEvent),
    CombatQueryHealthResponse(gameevents::CombatQueryHealthResponse),
    CharacterQueryAgeResponse(gameevents::CharacterQueryAgeResponse),
    ItemUseDone(gameevents::ItemUseDone),
    AllegianceAllegianceUpdateDone(gameevents::AllegianceAllegianceUpdateDone),
    FellowshipFellowUpdateDone(gameevents::FellowshipFellowUpdateDone),
    FellowshipFellowStatsDone(gameevents::FellowshipFellowStatsDone),
    ItemAppraiseDone(gameevents::ItemAppraiseDone),
    CharacterReturnPing(gameevents::CharacterReturnPing),
    CommunicationSetSquelchDB(gameevents::CommunicationSetSquelchDB),
    TradeRegisterTrade(gameevents::TradeRegisterTrade),
    TradeOpenTrade(gameevents::TradeOpenTrade),
    TradeCloseTrade(gameevents::TradeCloseTrade),
    TradeAddToTrade(gameevents::TradeAddToTrade),
    TradeRemoveFromTrade(gameevents::TradeRemoveFromTrade),
    TradeAcceptTrade(gameevents::TradeAcceptTrade),
    TradeDeclineTrade(gameevents::TradeDeclineTrade),
    TradeResetTrade(gameevents::TradeResetTrade),
    TradeTradeFailure(gameevents::TradeTradeFailure),
    TradeClearTradeAcceptance(gameevents::TradeClearTradeAcceptance),
    HouseHouseProfile(gameevents::HouseHouseProfile),
    HouseHouseData(gameevents::HouseHouseData),
    HouseHouseStatus(gameevents::HouseHouseStatus),
    HouseUpdateRentTime(gameevents::HouseUpdateRentTime),
    HouseUpdateRentPayment(gameevents::HouseUpdateRentPayment),
    HouseUpdateRestrictions(gameevents::HouseUpdateRestrictions),
    HouseUpdateHAR(gameevents::HouseUpdateHAR),
    HouseHouseTransaction(gameevents::HouseHouseTransaction),
    ItemQueryItemManaResponse(gameevents::ItemQueryItemManaResponse),
    HouseAvailableHouses(gameevents::HouseAvailableHouses),
    CharacterConfirmationRequest(gameevents::CharacterConfirmationRequest),
    CharacterConfirmationDone(gameevents::CharacterConfirmationDone),
    AllegianceAllegianceLoginNotificationEvent(gameevents::AllegianceAllegianceLoginNotificationEvent),
    AllegianceAllegianceInfoResponseEvent(gameevents::AllegianceAllegianceInfoResponseEvent),
    GameJoinGameResponse(gameevents::GameJoinGameResponse),
    GameStartGame(gameevents::GameStartGame),
    GameMoveResponse(gameevents::GameMoveResponse),
    GameOpponentTurn(gameevents::GameOpponentTurn),
    GameOpponentStalemateState(gameevents::GameOpponentStalemateState),
    CommunicationWeenieError(gameevents::CommunicationWeenieError),
    CommunicationWeenieErrorWithString(gameevents::CommunicationWeenieErrorWithString),
    GameGameOver(gameevents::GameGameOver),
    CommunicationChatRoomTracker(gameevents::CommunicationChatRoomTracker),
    AdminQueryPluginList(gameevents::AdminQueryPluginList),
    AdminQueryPlugin(gameevents::AdminQueryPlugin),
    AdminQueryPluginResponse2(gameevents::AdminQueryPluginResponse2),
    InventorySalvageOperationsResultData(gameevents::InventorySalvageOperationsResultData),
    CommunicationHearDirectSpeech(gameevents::CommunicationHearDirectSpeech),
    FellowshipFullUpdate(gameevents::FellowshipFullUpdate),
    FellowshipDisband(gameevents::FellowshipDisband),
    FellowshipUpdateFellow(gameevents::FellowshipUpdateFellow),
    MagicUpdateSpell(gameevents::MagicUpdateSpell),
    MagicUpdateEnchantment(gameevents::MagicUpdateEnchantment),
    MagicRemoveEnchantment(gameevents::MagicRemoveEnchantment),
    MagicUpdateMultipleEnchantments(gameevents::MagicUpdateMultipleEnchantments),
    MagicRemoveMultipleEnchantments(gameevents::MagicRemoveMultipleEnchantments),
    MagicPurgeEnchantments(gameevents::MagicPurgeEnchantments),
    MagicDispelEnchantment(gameevents::MagicDispelEnchantment),
    MagicDispelMultipleEnchantments(gameevents::MagicDispelMultipleEnchantments),
    MiscPortalStormBrewing(gameevents::MiscPortalStormBrewing),
    MiscPortalStormImminent(gameevents::MiscPortalStormImminent),
    MiscPortalStorm(gameevents::MiscPortalStorm),
    MiscPortalStormSubsided(gameevents::MiscPortalStormSubsided),
    CommunicationTransientString(gameevents::CommunicationTransientString),
    MagicPurgeBadEnchantments(gameevents::MagicPurgeBadEnchantments),
    SocialSendClientContractTrackerTable(gameevents::SocialSendClientContractTrackerTable),
    SocialSendClientContractTracker(gameevents::SocialSendClientContractTracker),
}

impl GameEventMessage {
    pub fn read(reader: &mut dyn ACReader) -> Result<Self, Box<dyn std::error::Error>> {
        let opcode = read_u32(reader)?;
        let opcode_enum = crate::enums::GameEvent::try_from(opcode)
            .map_err(|_| format!("Unknown GameEventMessage opcode: 0x{:04X}", opcode))?;

        match opcode_enum {
            crate::enums::GameEvent::AllegianceAllegianceUpdateAborted => Ok(GameEventMessage::AllegianceAllegianceUpdateAborted(gameevents::AllegianceAllegianceUpdateAborted::read(reader)?)),
            crate::enums::GameEvent::CommunicationPopUpString => Ok(GameEventMessage::CommunicationPopUpString(gameevents::CommunicationPopUpString::read(reader)?)),
            crate::enums::GameEvent::LoginPlayerDescription => Ok(GameEventMessage::LoginPlayerDescription(Box::new(gameevents::LoginPlayerDescription::read(reader)?))),
            crate::enums::GameEvent::AllegianceAllegianceUpdate => Ok(GameEventMessage::AllegianceAllegianceUpdate(gameevents::AllegianceAllegianceUpdate::read(reader)?)),
            crate::enums::GameEvent::SocialFriendsUpdate => Ok(GameEventMessage::SocialFriendsUpdate(gameevents::SocialFriendsUpdate::read(reader)?)),
            crate::enums::GameEvent::ItemServerSaysContainId => Ok(GameEventMessage::ItemServerSaysContainId(gameevents::ItemServerSaysContainId::read(reader)?)),
            crate::enums::GameEvent::ItemWearItem => Ok(GameEventMessage::ItemWearItem(gameevents::ItemWearItem::read(reader)?)),
            crate::enums::GameEvent::SocialCharacterTitleTable => Ok(GameEventMessage::SocialCharacterTitleTable(gameevents::SocialCharacterTitleTable::read(reader)?)),
            crate::enums::GameEvent::SocialAddOrSetCharacterTitle => Ok(GameEventMessage::SocialAddOrSetCharacterTitle(gameevents::SocialAddOrSetCharacterTitle::read(reader)?)),
            crate::enums::GameEvent::ItemStopViewingObjectContents => Ok(GameEventMessage::ItemStopViewingObjectContents(gameevents::ItemStopViewingObjectContents::read(reader)?)),
            crate::enums::GameEvent::VendorVendorInfo => Ok(GameEventMessage::VendorVendorInfo(gameevents::VendorVendorInfo::read(reader)?)),
            crate::enums::GameEvent::CharacterStartBarber => Ok(GameEventMessage::CharacterStartBarber(gameevents::CharacterStartBarber::read(reader)?)),
            crate::enums::GameEvent::FellowshipQuit => Ok(GameEventMessage::FellowshipQuit(gameevents::FellowshipQuit::read(reader)?)),
            crate::enums::GameEvent::FellowshipDismiss => Ok(GameEventMessage::FellowshipDismiss(gameevents::FellowshipDismiss::read(reader)?)),
            crate::enums::GameEvent::WritingBookOpen => Ok(GameEventMessage::WritingBookOpen(gameevents::WritingBookOpen::read(reader)?)),
            crate::enums::GameEvent::WritingBookAddPageResponse => Ok(GameEventMessage::WritingBookAddPageResponse(gameevents::WritingBookAddPageResponse::read(reader)?)),
            crate::enums::GameEvent::WritingBookDeletePageResponse => Ok(GameEventMessage::WritingBookDeletePageResponse(gameevents::WritingBookDeletePageResponse::read(reader)?)),
            crate::enums::GameEvent::WritingBookPageDataResponse => Ok(GameEventMessage::WritingBookPageDataResponse(gameevents::WritingBookPageDataResponse::read(reader)?)),
            crate::enums::GameEvent::ItemGetInscriptionResponse => Ok(GameEventMessage::ItemGetInscriptionResponse(gameevents::ItemGetInscriptionResponse::read(reader)?)),
            crate::enums::GameEvent::ItemSetAppraiseInfo => Ok(GameEventMessage::ItemSetAppraiseInfo(Box::new(gameevents::ItemSetAppraiseInfo::read(reader)?))),
            crate::enums::GameEvent::CommunicationChannelBroadcast => Ok(GameEventMessage::CommunicationChannelBroadcast(gameevents::CommunicationChannelBroadcast::read(reader)?)),
            crate::enums::GameEvent::CommunicationChannelList => Ok(GameEventMessage::CommunicationChannelList(gameevents::CommunicationChannelList::read(reader)?)),
            crate::enums::GameEvent::CommunicationChannelIndex => Ok(GameEventMessage::CommunicationChannelIndex(gameevents::CommunicationChannelIndex::read(reader)?)),
            crate::enums::GameEvent::ItemOnViewContents => Ok(GameEventMessage::ItemOnViewContents(gameevents::ItemOnViewContents::read(reader)?)),
            crate::enums::GameEvent::ItemServerSaysMoveItem => Ok(GameEventMessage::ItemServerSaysMoveItem(gameevents::ItemServerSaysMoveItem::read(reader)?)),
            crate::enums::GameEvent::CombatHandleAttackDoneEvent => Ok(GameEventMessage::CombatHandleAttackDoneEvent(gameevents::CombatHandleAttackDoneEvent::read(reader)?)),
            crate::enums::GameEvent::MagicRemoveSpell => Ok(GameEventMessage::MagicRemoveSpell(gameevents::MagicRemoveSpell::read(reader)?)),
            crate::enums::GameEvent::CombatHandleVictimNotificationEventSelf => Ok(GameEventMessage::CombatHandleVictimNotificationEventSelf(gameevents::CombatHandleVictimNotificationEventSelf::read(reader)?)),
            crate::enums::GameEvent::CombatHandleVictimNotificationEventOther => Ok(GameEventMessage::CombatHandleVictimNotificationEventOther(gameevents::CombatHandleVictimNotificationEventOther::read(reader)?)),
            crate::enums::GameEvent::CombatHandleAttackerNotificationEvent => Ok(GameEventMessage::CombatHandleAttackerNotificationEvent(gameevents::CombatHandleAttackerNotificationEvent::read(reader)?)),
            crate::enums::GameEvent::CombatHandleDefenderNotificationEvent => Ok(GameEventMessage::CombatHandleDefenderNotificationEvent(gameevents::CombatHandleDefenderNotificationEvent::read(reader)?)),
            crate::enums::GameEvent::CombatHandleEvasionAttackerNotificationEvent => Ok(GameEventMessage::CombatHandleEvasionAttackerNotificationEvent(gameevents::CombatHandleEvasionAttackerNotificationEvent::read(reader)?)),
            crate::enums::GameEvent::CombatHandleEvasionDefenderNotificationEvent => Ok(GameEventMessage::CombatHandleEvasionDefenderNotificationEvent(gameevents::CombatHandleEvasionDefenderNotificationEvent::read(reader)?)),
            crate::enums::GameEvent::CombatHandleCommenceAttackEvent => Ok(GameEventMessage::CombatHandleCommenceAttackEvent(gameevents::CombatHandleCommenceAttackEvent::read(reader)?)),
            crate::enums::GameEvent::CombatQueryHealthResponse => Ok(GameEventMessage::CombatQueryHealthResponse(gameevents::CombatQueryHealthResponse::read(reader)?)),
            crate::enums::GameEvent::CharacterQueryAgeResponse => Ok(GameEventMessage::CharacterQueryAgeResponse(gameevents::CharacterQueryAgeResponse::read(reader)?)),
            crate::enums::GameEvent::ItemUseDone => Ok(GameEventMessage::ItemUseDone(gameevents::ItemUseDone::read(reader)?)),
            crate::enums::GameEvent::AllegianceAllegianceUpdateDone => Ok(GameEventMessage::AllegianceAllegianceUpdateDone(gameevents::AllegianceAllegianceUpdateDone::read(reader)?)),
            crate::enums::GameEvent::FellowshipFellowUpdateDone => Ok(GameEventMessage::FellowshipFellowUpdateDone(gameevents::FellowshipFellowUpdateDone::read(reader)?)),
            crate::enums::GameEvent::FellowshipFellowStatsDone => Ok(GameEventMessage::FellowshipFellowStatsDone(gameevents::FellowshipFellowStatsDone::read(reader)?)),
            crate::enums::GameEvent::ItemAppraiseDone => Ok(GameEventMessage::ItemAppraiseDone(gameevents::ItemAppraiseDone::read(reader)?)),
            crate::enums::GameEvent::CharacterReturnPing => Ok(GameEventMessage::CharacterReturnPing(gameevents::CharacterReturnPing::read(reader)?)),
            crate::enums::GameEvent::CommunicationSetSquelchDB => Ok(GameEventMessage::CommunicationSetSquelchDB(gameevents::CommunicationSetSquelchDB::read(reader)?)),
            crate::enums::GameEvent::TradeRegisterTrade => Ok(GameEventMessage::TradeRegisterTrade(gameevents::TradeRegisterTrade::read(reader)?)),
            crate::enums::GameEvent::TradeOpenTrade => Ok(GameEventMessage::TradeOpenTrade(gameevents::TradeOpenTrade::read(reader)?)),
            crate::enums::GameEvent::TradeCloseTrade => Ok(GameEventMessage::TradeCloseTrade(gameevents::TradeCloseTrade::read(reader)?)),
            crate::enums::GameEvent::TradeAddToTrade => Ok(GameEventMessage::TradeAddToTrade(gameevents::TradeAddToTrade::read(reader)?)),
            crate::enums::GameEvent::TradeRemoveFromTrade => Ok(GameEventMessage::TradeRemoveFromTrade(gameevents::TradeRemoveFromTrade::read(reader)?)),
            crate::enums::GameEvent::TradeAcceptTrade => Ok(GameEventMessage::TradeAcceptTrade(gameevents::TradeAcceptTrade::read(reader)?)),
            crate::enums::GameEvent::TradeDeclineTrade => Ok(GameEventMessage::TradeDeclineTrade(gameevents::TradeDeclineTrade::read(reader)?)),
            crate::enums::GameEvent::TradeResetTrade => Ok(GameEventMessage::TradeResetTrade(gameevents::TradeResetTrade::read(reader)?)),
            crate::enums::GameEvent::TradeTradeFailure => Ok(GameEventMessage::TradeTradeFailure(gameevents::TradeTradeFailure::read(reader)?)),
            crate::enums::GameEvent::TradeClearTradeAcceptance => Ok(GameEventMessage::TradeClearTradeAcceptance(gameevents::TradeClearTradeAcceptance::read(reader)?)),
            crate::enums::GameEvent::HouseHouseProfile => Ok(GameEventMessage::HouseHouseProfile(gameevents::HouseHouseProfile::read(reader)?)),
            crate::enums::GameEvent::HouseHouseData => Ok(GameEventMessage::HouseHouseData(gameevents::HouseHouseData::read(reader)?)),
            crate::enums::GameEvent::HouseHouseStatus => Ok(GameEventMessage::HouseHouseStatus(gameevents::HouseHouseStatus::read(reader)?)),
            crate::enums::GameEvent::HouseUpdateRentTime => Ok(GameEventMessage::HouseUpdateRentTime(gameevents::HouseUpdateRentTime::read(reader)?)),
            crate::enums::GameEvent::HouseUpdateRentPayment => Ok(GameEventMessage::HouseUpdateRentPayment(gameevents::HouseUpdateRentPayment::read(reader)?)),
            crate::enums::GameEvent::HouseUpdateRestrictions => Ok(GameEventMessage::HouseUpdateRestrictions(gameevents::HouseUpdateRestrictions::read(reader)?)),
            crate::enums::GameEvent::HouseUpdateHAR => Ok(GameEventMessage::HouseUpdateHAR(gameevents::HouseUpdateHAR::read(reader)?)),
            crate::enums::GameEvent::HouseHouseTransaction => Ok(GameEventMessage::HouseHouseTransaction(gameevents::HouseHouseTransaction::read(reader)?)),
            crate::enums::GameEvent::ItemQueryItemManaResponse => Ok(GameEventMessage::ItemQueryItemManaResponse(gameevents::ItemQueryItemManaResponse::read(reader)?)),
            crate::enums::GameEvent::HouseAvailableHouses => Ok(GameEventMessage::HouseAvailableHouses(gameevents::HouseAvailableHouses::read(reader)?)),
            crate::enums::GameEvent::CharacterConfirmationRequest => Ok(GameEventMessage::CharacterConfirmationRequest(gameevents::CharacterConfirmationRequest::read(reader)?)),
            crate::enums::GameEvent::CharacterConfirmationDone => Ok(GameEventMessage::CharacterConfirmationDone(gameevents::CharacterConfirmationDone::read(reader)?)),
            crate::enums::GameEvent::AllegianceAllegianceLoginNotificationEvent => Ok(GameEventMessage::AllegianceAllegianceLoginNotificationEvent(gameevents::AllegianceAllegianceLoginNotificationEvent::read(reader)?)),
            crate::enums::GameEvent::AllegianceAllegianceInfoResponseEvent => Ok(GameEventMessage::AllegianceAllegianceInfoResponseEvent(gameevents::AllegianceAllegianceInfoResponseEvent::read(reader)?)),
            crate::enums::GameEvent::GameJoinGameResponse => Ok(GameEventMessage::GameJoinGameResponse(gameevents::GameJoinGameResponse::read(reader)?)),
            crate::enums::GameEvent::GameStartGame => Ok(GameEventMessage::GameStartGame(gameevents::GameStartGame::read(reader)?)),
            crate::enums::GameEvent::GameMoveResponse => Ok(GameEventMessage::GameMoveResponse(gameevents::GameMoveResponse::read(reader)?)),
            crate::enums::GameEvent::GameOpponentTurn => Ok(GameEventMessage::GameOpponentTurn(gameevents::GameOpponentTurn::read(reader)?)),
            crate::enums::GameEvent::GameOpponentStalemateState => Ok(GameEventMessage::GameOpponentStalemateState(gameevents::GameOpponentStalemateState::read(reader)?)),
            crate::enums::GameEvent::CommunicationWeenieError => Ok(GameEventMessage::CommunicationWeenieError(gameevents::CommunicationWeenieError::read(reader)?)),
            crate::enums::GameEvent::CommunicationWeenieErrorWithString => Ok(GameEventMessage::CommunicationWeenieErrorWithString(gameevents::CommunicationWeenieErrorWithString::read(reader)?)),
            crate::enums::GameEvent::GameGameOver => Ok(GameEventMessage::GameGameOver(gameevents::GameGameOver::read(reader)?)),
            crate::enums::GameEvent::CommunicationChatRoomTracker => Ok(GameEventMessage::CommunicationChatRoomTracker(gameevents::CommunicationChatRoomTracker::read(reader)?)),
            crate::enums::GameEvent::AdminQueryPluginList => Ok(GameEventMessage::AdminQueryPluginList(gameevents::AdminQueryPluginList::read(reader)?)),
            crate::enums::GameEvent::AdminQueryPlugin => Ok(GameEventMessage::AdminQueryPlugin(gameevents::AdminQueryPlugin::read(reader)?)),
            crate::enums::GameEvent::AdminQueryPluginResponse2 => Ok(GameEventMessage::AdminQueryPluginResponse2(gameevents::AdminQueryPluginResponse2::read(reader)?)),
            crate::enums::GameEvent::InventorySalvageOperationsResultData => Ok(GameEventMessage::InventorySalvageOperationsResultData(gameevents::InventorySalvageOperationsResultData::read(reader)?)),
            crate::enums::GameEvent::CommunicationHearDirectSpeech => Ok(GameEventMessage::CommunicationHearDirectSpeech(gameevents::CommunicationHearDirectSpeech::read(reader)?)),
            crate::enums::GameEvent::FellowshipFullUpdate => Ok(GameEventMessage::FellowshipFullUpdate(gameevents::FellowshipFullUpdate::read(reader)?)),
            crate::enums::GameEvent::FellowshipDisband => Ok(GameEventMessage::FellowshipDisband(gameevents::FellowshipDisband::read(reader)?)),
            crate::enums::GameEvent::FellowshipUpdateFellow => Ok(GameEventMessage::FellowshipUpdateFellow(gameevents::FellowshipUpdateFellow::read(reader)?)),
            crate::enums::GameEvent::MagicUpdateSpell => Ok(GameEventMessage::MagicUpdateSpell(gameevents::MagicUpdateSpell::read(reader)?)),
            crate::enums::GameEvent::MagicUpdateEnchantment => Ok(GameEventMessage::MagicUpdateEnchantment(gameevents::MagicUpdateEnchantment::read(reader)?)),
            crate::enums::GameEvent::MagicRemoveEnchantment => Ok(GameEventMessage::MagicRemoveEnchantment(gameevents::MagicRemoveEnchantment::read(reader)?)),
            crate::enums::GameEvent::MagicUpdateMultipleEnchantments => Ok(GameEventMessage::MagicUpdateMultipleEnchantments(gameevents::MagicUpdateMultipleEnchantments::read(reader)?)),
            crate::enums::GameEvent::MagicRemoveMultipleEnchantments => Ok(GameEventMessage::MagicRemoveMultipleEnchantments(gameevents::MagicRemoveMultipleEnchantments::read(reader)?)),
            crate::enums::GameEvent::MagicPurgeEnchantments => Ok(GameEventMessage::MagicPurgeEnchantments(gameevents::MagicPurgeEnchantments::read(reader)?)),
            crate::enums::GameEvent::MagicDispelEnchantment => Ok(GameEventMessage::MagicDispelEnchantment(gameevents::MagicDispelEnchantment::read(reader)?)),
            crate::enums::GameEvent::MagicDispelMultipleEnchantments => Ok(GameEventMessage::MagicDispelMultipleEnchantments(gameevents::MagicDispelMultipleEnchantments::read(reader)?)),
            crate::enums::GameEvent::MiscPortalStormBrewing => Ok(GameEventMessage::MiscPortalStormBrewing(gameevents::MiscPortalStormBrewing::read(reader)?)),
            crate::enums::GameEvent::MiscPortalStormImminent => Ok(GameEventMessage::MiscPortalStormImminent(gameevents::MiscPortalStormImminent::read(reader)?)),
            crate::enums::GameEvent::MiscPortalStorm => Ok(GameEventMessage::MiscPortalStorm(gameevents::MiscPortalStorm::read(reader)?)),
            crate::enums::GameEvent::MiscPortalStormSubsided => Ok(GameEventMessage::MiscPortalStormSubsided(gameevents::MiscPortalStormSubsided::read(reader)?)),
            crate::enums::GameEvent::CommunicationTransientString => Ok(GameEventMessage::CommunicationTransientString(gameevents::CommunicationTransientString::read(reader)?)),
            crate::enums::GameEvent::MagicPurgeBadEnchantments => Ok(GameEventMessage::MagicPurgeBadEnchantments(gameevents::MagicPurgeBadEnchantments::read(reader)?)),
            crate::enums::GameEvent::SocialSendClientContractTrackerTable => Ok(GameEventMessage::SocialSendClientContractTrackerTable(gameevents::SocialSendClientContractTrackerTable::read(reader)?)),
            crate::enums::GameEvent::SocialSendClientContractTracker => Ok(GameEventMessage::SocialSendClientContractTracker(gameevents::SocialSendClientContractTracker::read(reader)?)),
        }
    }

    pub fn queue(&self) -> Option<MessageQueue> {
        match self {
            GameEventMessage::AllegianceAllegianceUpdateAborted(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CommunicationPopUpString(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::LoginPlayerDescription(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::AllegianceAllegianceUpdate(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::SocialFriendsUpdate(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::ItemServerSaysContainId(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::ItemWearItem(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::SocialCharacterTitleTable(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::SocialAddOrSetCharacterTitle(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::ItemStopViewingObjectContents(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::VendorVendorInfo(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CharacterStartBarber(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::FellowshipQuit(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::FellowshipDismiss(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::WritingBookOpen(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::WritingBookAddPageResponse(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::WritingBookDeletePageResponse(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::WritingBookPageDataResponse(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::ItemGetInscriptionResponse(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::ItemSetAppraiseInfo(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CommunicationChannelBroadcast(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CommunicationChannelList(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CommunicationChannelIndex(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::ItemOnViewContents(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::ItemServerSaysMoveItem(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CombatHandleAttackDoneEvent(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MagicRemoveSpell(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CombatHandleVictimNotificationEventSelf(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CombatHandleVictimNotificationEventOther(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CombatHandleAttackerNotificationEvent(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CombatHandleDefenderNotificationEvent(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CombatHandleEvasionAttackerNotificationEvent(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CombatHandleEvasionDefenderNotificationEvent(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CombatHandleCommenceAttackEvent(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CombatQueryHealthResponse(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CharacterQueryAgeResponse(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::ItemUseDone(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::AllegianceAllegianceUpdateDone(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::FellowshipFellowUpdateDone(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::FellowshipFellowStatsDone(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::ItemAppraiseDone(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CharacterReturnPing(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CommunicationSetSquelchDB(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::TradeRegisterTrade(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::TradeOpenTrade(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::TradeCloseTrade(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::TradeAddToTrade(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::TradeRemoveFromTrade(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::TradeAcceptTrade(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::TradeDeclineTrade(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::TradeResetTrade(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::TradeTradeFailure(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::TradeClearTradeAcceptance(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::HouseHouseProfile(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::HouseHouseData(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::HouseHouseStatus(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::HouseUpdateRentTime(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::HouseUpdateRentPayment(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::HouseUpdateRestrictions(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::HouseUpdateHAR(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::HouseHouseTransaction(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::ItemQueryItemManaResponse(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::HouseAvailableHouses(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CharacterConfirmationRequest(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CharacterConfirmationDone(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::AllegianceAllegianceLoginNotificationEvent(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::AllegianceAllegianceInfoResponseEvent(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::GameJoinGameResponse(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::GameStartGame(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::GameMoveResponse(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::GameOpponentTurn(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::GameOpponentStalemateState(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CommunicationWeenieError(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CommunicationWeenieErrorWithString(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::GameGameOver(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CommunicationChatRoomTracker(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::AdminQueryPluginList(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::AdminQueryPlugin(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::AdminQueryPluginResponse2(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::InventorySalvageOperationsResultData(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CommunicationHearDirectSpeech(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::FellowshipFullUpdate(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::FellowshipDisband(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::FellowshipUpdateFellow(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MagicUpdateSpell(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MagicUpdateEnchantment(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MagicRemoveEnchantment(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MagicUpdateMultipleEnchantments(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MagicRemoveMultipleEnchantments(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MagicPurgeEnchantments(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MagicDispelEnchantment(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MagicDispelMultipleEnchantments(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MiscPortalStormBrewing(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MiscPortalStormImminent(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MiscPortalStorm(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MiscPortalStormSubsided(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::CommunicationTransientString(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::MagicPurgeBadEnchantments(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::SocialSendClientContractTrackerTable(_) => Some(MessageQueue::UIQueue),
            GameEventMessage::SocialSendClientContractTracker(_) => Some(MessageQueue::UIQueue),
        }
    }
}

/// C2SMessage enum with message data
#[derive(Debug, Serialize, Deserialize)]
pub enum C2SMessage {
    LoginLogOffCharacter(c2s::LoginLogOffCharacter),
    CharacterCharacterDelete(c2s::CharacterCharacterDelete),
    CharacterSendCharGenResult(c2s::CharacterSendCharGenResult),
    LoginSendEnterWorld(c2s::LoginSendEnterWorld),
    ObjectSendForceObjdesc(c2s::ObjectSendForceObjdesc),
    LoginSendEnterWorldRequest(c2s::LoginSendEnterWorldRequest),
    AdminSendAdminGetServerVersion(c2s::AdminSendAdminGetServerVersion),
    SocialSendFriendsCommand(c2s::SocialSendFriendsCommand),
    AdminSendAdminRestoreCharacter(c2s::AdminSendAdminRestoreCharacter),
    CommunicationTurbineChat(c2s::CommunicationTurbineChat),
    DDDRequestDataMessage(c2s::DDDRequestDataMessage),
    DDDInterrogationResponseMessage(c2s::DDDInterrogationResponseMessage),
    DDDEndDDDMessage(c2s::DDDEndDDDMessage),
    DDDOnEndDDD(c2s::DDDOnEndDDD),
    OrderedGameAction {
        sequence: u32,
        action: GameActionMessage,
    },
}

impl C2SMessage {
    pub fn read(reader: &mut dyn ACReader) -> Result<Self, Box<dyn std::error::Error>> {
        let opcode = read_u32(reader)?;
        let opcode_enum = crate::enums::C2SMessage::try_from(opcode)
            .map_err(|_| format!("Unknown C2SMessage opcode: 0x{:04X}", opcode))?;

        match opcode_enum {
            crate::enums::C2SMessage::LoginLogOffCharacter => Ok(C2SMessage::LoginLogOffCharacter(c2s::LoginLogOffCharacter::read(reader)?)),
            crate::enums::C2SMessage::CharacterCharacterDelete => Ok(C2SMessage::CharacterCharacterDelete(c2s::CharacterCharacterDelete::read(reader)?)),
            crate::enums::C2SMessage::CharacterSendCharGenResult => Ok(C2SMessage::CharacterSendCharGenResult(c2s::CharacterSendCharGenResult::read(reader)?)),
            crate::enums::C2SMessage::LoginSendEnterWorld => Ok(C2SMessage::LoginSendEnterWorld(c2s::LoginSendEnterWorld::read(reader)?)),
            crate::enums::C2SMessage::ObjectSendForceObjdesc => Ok(C2SMessage::ObjectSendForceObjdesc(c2s::ObjectSendForceObjdesc::read(reader)?)),
            crate::enums::C2SMessage::LoginSendEnterWorldRequest => Ok(C2SMessage::LoginSendEnterWorldRequest(c2s::LoginSendEnterWorldRequest::read(reader)?)),
            crate::enums::C2SMessage::AdminSendAdminGetServerVersion => Ok(C2SMessage::AdminSendAdminGetServerVersion(c2s::AdminSendAdminGetServerVersion::read(reader)?)),
            crate::enums::C2SMessage::SocialSendFriendsCommand => Ok(C2SMessage::SocialSendFriendsCommand(c2s::SocialSendFriendsCommand::read(reader)?)),
            crate::enums::C2SMessage::AdminSendAdminRestoreCharacter => Ok(C2SMessage::AdminSendAdminRestoreCharacter(c2s::AdminSendAdminRestoreCharacter::read(reader)?)),
            crate::enums::C2SMessage::CommunicationTurbineChat => Ok(C2SMessage::CommunicationTurbineChat(c2s::CommunicationTurbineChat::read(reader)?)),
            crate::enums::C2SMessage::DDDRequestDataMessage => Ok(C2SMessage::DDDRequestDataMessage(c2s::DDDRequestDataMessage::read(reader)?)),
            crate::enums::C2SMessage::DDDInterrogationResponseMessage => Ok(C2SMessage::DDDInterrogationResponseMessage(c2s::DDDInterrogationResponseMessage::read(reader)?)),
            crate::enums::C2SMessage::DDDEndDDDMessage => Ok(C2SMessage::DDDEndDDDMessage(c2s::DDDEndDDDMessage::read(reader)?)),
            crate::enums::C2SMessage::DDDOnEndDDD => Ok(C2SMessage::DDDOnEndDDD(c2s::DDDOnEndDDD::read(reader)?)),
            crate::enums::C2SMessage::OrderedGameAction => {
                let sequence = read_u32(reader)?;
                let action = GameActionMessage::read(reader)?;
                Ok(C2SMessage::OrderedGameAction { sequence, action })
            }
        }
    }

    pub fn queue(&self) -> Option<MessageQueue> {
        match self {
            C2SMessage::LoginLogOffCharacter(_) => Some(MessageQueue::Logon),
            C2SMessage::CharacterCharacterDelete(_) => Some(MessageQueue::Logon),
            C2SMessage::CharacterSendCharGenResult(_) => Some(MessageQueue::Logon),
            C2SMessage::LoginSendEnterWorld(_) => Some(MessageQueue::Logon),
            C2SMessage::ObjectSendForceObjdesc(_) => Some(MessageQueue::Control),
            C2SMessage::LoginSendEnterWorldRequest(_) => Some(MessageQueue::Logon),
            C2SMessage::AdminSendAdminGetServerVersion(_) => Some(MessageQueue::Control),
            C2SMessage::SocialSendFriendsCommand(_) => Some(MessageQueue::Control),
            C2SMessage::AdminSendAdminRestoreCharacter(_) => Some(MessageQueue::Control),
            C2SMessage::CommunicationTurbineChat(_) => Some(MessageQueue::Logon),
            C2SMessage::DDDRequestDataMessage(_) => Some(MessageQueue::CLCache),
            C2SMessage::DDDInterrogationResponseMessage(_) => Some(MessageQueue::CLCache),
            C2SMessage::DDDEndDDDMessage(_) => Some(MessageQueue::CLCache),
            C2SMessage::DDDOnEndDDD(_) => Some(MessageQueue::CLCache),
            C2SMessage::OrderedGameAction { action, .. } => action.queue(),
        }
    }
}

/// S2CMessage enum with message data
#[derive(Debug, Serialize, Deserialize)]
pub enum S2CMessage {
    ItemServerSaysRemove(s2c::ItemServerSaysRemove),
    CharacterServerSaysAttemptFailed(s2c::CharacterServerSaysAttemptFailed),
    ItemUpdateStackSize(s2c::ItemUpdateStackSize),
    CombatHandlePlayerDeathEvent(s2c::CombatHandlePlayerDeathEvent),
    QualitiesPrivateRemoveIntEvent(s2c::QualitiesPrivateRemoveIntEvent),
    QualitiesRemoveIntEvent(s2c::QualitiesRemoveIntEvent),
    QualitiesPrivateRemoveBoolEvent(s2c::QualitiesPrivateRemoveBoolEvent),
    QualitiesRemoveBoolEvent(s2c::QualitiesRemoveBoolEvent),
    QualitiesPrivateRemoveFloatEvent(s2c::QualitiesPrivateRemoveFloatEvent),
    QualitiesRemoveFloatEvent(s2c::QualitiesRemoveFloatEvent),
    QualitiesPrivateRemoveStringEvent(s2c::QualitiesPrivateRemoveStringEvent),
    QualitiesRemoveStringEvent(s2c::QualitiesRemoveStringEvent),
    QualitiesPrivateRemoveDataIdEvent(s2c::QualitiesPrivateRemoveDataIdEvent),
    QualitiesRemoveDataIdEvent(s2c::QualitiesRemoveDataIdEvent),
    QualitiesPrivateRemoveInstanceIdEvent(s2c::QualitiesPrivateRemoveInstanceIdEvent),
    QualitiesRemoveInstanceIdEvent(s2c::QualitiesRemoveInstanceIdEvent),
    QualitiesPrivateRemovePositionEvent(s2c::QualitiesPrivateRemovePositionEvent),
    QualitiesRemovePositionEvent(s2c::QualitiesRemovePositionEvent),
    QualitiesPrivateRemoveInt64Event(s2c::QualitiesPrivateRemoveInt64Event),
    QualitiesRemoveInt64Event(s2c::QualitiesRemoveInt64Event),
    QualitiesPrivateUpdateInt(s2c::QualitiesPrivateUpdateInt),
    QualitiesUpdateInt(s2c::QualitiesUpdateInt),
    QualitiesPrivateUpdateInt64(s2c::QualitiesPrivateUpdateInt64),
    QualitiesUpdateInt64(s2c::QualitiesUpdateInt64),
    QualitiesPrivateUpdateBool(s2c::QualitiesPrivateUpdateBool),
    QualitiesUpdateBool(s2c::QualitiesUpdateBool),
    QualitiesPrivateUpdateFloat(s2c::QualitiesPrivateUpdateFloat),
    QualitiesUpdateFloat(s2c::QualitiesUpdateFloat),
    QualitiesPrivateUpdateString(s2c::QualitiesPrivateUpdateString),
    QualitiesUpdateString(s2c::QualitiesUpdateString),
    QualitiesPrivateUpdateDataId(s2c::QualitiesPrivateUpdateDataId),
    QualitiesUpdateDataId(s2c::QualitiesUpdateDataId),
    QualitiesPrivateUpdateInstanceId(s2c::QualitiesPrivateUpdateInstanceId),
    QualitiesUpdateInstanceId(s2c::QualitiesUpdateInstanceId),
    QualitiesPrivateUpdatePosition(s2c::QualitiesPrivateUpdatePosition),
    QualitiesUpdatePosition(s2c::QualitiesUpdatePosition),
    QualitiesPrivateUpdateSkill(s2c::QualitiesPrivateUpdateSkill),
    QualitiesUpdateSkill(s2c::QualitiesUpdateSkill),
    QualitiesPrivateUpdateSkillLevel(s2c::QualitiesPrivateUpdateSkillLevel),
    QualitiesUpdateSkillLevel(s2c::QualitiesUpdateSkillLevel),
    QualitiesPrivateUpdateSkillAC(s2c::QualitiesPrivateUpdateSkillAC),
    QualitiesUpdateSkillAC(s2c::QualitiesUpdateSkillAC),
    QualitiesPrivateUpdateAttribute(s2c::QualitiesPrivateUpdateAttribute),
    QualitiesUpdateAttribute(s2c::QualitiesUpdateAttribute),
    QualitiesPrivateUpdateAttributeLevel(s2c::QualitiesPrivateUpdateAttributeLevel),
    QualitiesUpdateAttributeLevel(s2c::QualitiesUpdateAttributeLevel),
    QualitiesPrivateUpdateAttribute2nd(s2c::QualitiesPrivateUpdateAttribute2nd),
    QualitiesUpdateAttribute2nd(s2c::QualitiesUpdateAttribute2nd),
    QualitiesPrivateUpdateAttribute2ndLevel(s2c::QualitiesPrivateUpdateAttribute2ndLevel),
    QualitiesUpdateAttribute2ndLevel(s2c::QualitiesUpdateAttribute2ndLevel),
    CommunicationHearEmote(s2c::CommunicationHearEmote),
    CommunicationHearSoulEmote(s2c::CommunicationHearSoulEmote),
    CommunicationHearSpeech(s2c::CommunicationHearSpeech),
    CommunicationHearRangedSpeech(s2c::CommunicationHearRangedSpeech),
    AdminEnvirons(s2c::AdminEnvirons),
    MovementPositionAndMovementEvent(s2c::MovementPositionAndMovementEvent),
    ItemObjDescEvent(s2c::ItemObjDescEvent),
    CharacterSetPlayerVisualDesc(s2c::CharacterSetPlayerVisualDesc),
    CharacterCharGenVerificationResponse(s2c::CharacterCharGenVerificationResponse),
    LoginAwaitingSubscriptionExpiration(s2c::LoginAwaitingSubscriptionExpiration),
    LoginLogOffCharacter(s2c::LoginLogOffCharacter),
    CharacterCharacterDelete(s2c::CharacterCharacterDelete),
    LoginLoginCharacterSet(s2c::LoginLoginCharacterSet),
    CharacterCharacterError(s2c::CharacterCharacterError),
    ItemCreateObject(s2c::ItemCreateObject),
    LoginCreatePlayer(s2c::LoginCreatePlayer),
    ItemDeleteObject(s2c::ItemDeleteObject),
    MovementPositionEvent(s2c::MovementPositionEvent),
    ItemParentEvent(s2c::ItemParentEvent),
    InventoryPickupEvent(s2c::InventoryPickupEvent),
    ItemSetState(s2c::ItemSetState),
    MovementSetObjectMovement(s2c::MovementSetObjectMovement),
    MovementVectorUpdate(s2c::MovementVectorUpdate),
    EffectsSoundEvent(s2c::EffectsSoundEvent),
    EffectsPlayerTeleport(s2c::EffectsPlayerTeleport),
    EffectsPlayScriptId(s2c::EffectsPlayScriptId),
    EffectsPlayScriptType(s2c::EffectsPlayScriptType),
    LoginAccountBanned(s2c::LoginAccountBanned),
    AdminReceiveAccountData(s2c::AdminReceiveAccountData),
    AdminReceivePlayerData(s2c::AdminReceivePlayerData),
    ItemUpdateObject(s2c::ItemUpdateObject),
    LoginAccountBooted(s2c::LoginAccountBooted),
    CommunicationTurbineChat(s2c::CommunicationTurbineChat),
    LoginEnterGameServerReady(s2c::LoginEnterGameServerReady),
    CommunicationTextboxString(s2c::CommunicationTextboxString),
    LoginWorldInfo(s2c::LoginWorldInfo),
    DDDDataMessage(s2c::DDDDataMessage),
    DDDErrorMessage(s2c::DDDErrorMessage),
    DDDBeginDDDMessage(s2c::DDDBeginDDDMessage),
    DDDInterrogationMessage(s2c::DDDInterrogationMessage),
    DDDOnEndDDD(s2c::DDDOnEndDDD),
    OrderedGameEvent {
        object_id: u32,
        sequence: u32,
        event: Box<GameEventMessage>,
    },
}

impl S2CMessage {
    pub fn read(reader: &mut dyn ACReader) -> Result<Self, Box<dyn std::error::Error>> {
        let opcode = read_u32(reader)?;
        let opcode_enum = crate::enums::S2CMessage::try_from(opcode)
            .map_err(|_| format!("Unknown S2CMessage opcode: 0x{:04X}", opcode))?;

        match opcode_enum {
            crate::enums::S2CMessage::ItemServerSaysRemove => Ok(S2CMessage::ItemServerSaysRemove(s2c::ItemServerSaysRemove::read(reader)?)),
            crate::enums::S2CMessage::CharacterServerSaysAttemptFailed => Ok(S2CMessage::CharacterServerSaysAttemptFailed(s2c::CharacterServerSaysAttemptFailed::read(reader)?)),
            crate::enums::S2CMessage::ItemUpdateStackSize => Ok(S2CMessage::ItemUpdateStackSize(s2c::ItemUpdateStackSize::read(reader)?)),
            crate::enums::S2CMessage::CombatHandlePlayerDeathEvent => Ok(S2CMessage::CombatHandlePlayerDeathEvent(s2c::CombatHandlePlayerDeathEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateRemoveIntEvent => Ok(S2CMessage::QualitiesPrivateRemoveIntEvent(s2c::QualitiesPrivateRemoveIntEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesRemoveIntEvent => Ok(S2CMessage::QualitiesRemoveIntEvent(s2c::QualitiesRemoveIntEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateRemoveBoolEvent => Ok(S2CMessage::QualitiesPrivateRemoveBoolEvent(s2c::QualitiesPrivateRemoveBoolEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesRemoveBoolEvent => Ok(S2CMessage::QualitiesRemoveBoolEvent(s2c::QualitiesRemoveBoolEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateRemoveFloatEvent => Ok(S2CMessage::QualitiesPrivateRemoveFloatEvent(s2c::QualitiesPrivateRemoveFloatEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesRemoveFloatEvent => Ok(S2CMessage::QualitiesRemoveFloatEvent(s2c::QualitiesRemoveFloatEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateRemoveStringEvent => Ok(S2CMessage::QualitiesPrivateRemoveStringEvent(s2c::QualitiesPrivateRemoveStringEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesRemoveStringEvent => Ok(S2CMessage::QualitiesRemoveStringEvent(s2c::QualitiesRemoveStringEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateRemoveDataIdEvent => Ok(S2CMessage::QualitiesPrivateRemoveDataIdEvent(s2c::QualitiesPrivateRemoveDataIdEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesRemoveDataIdEvent => Ok(S2CMessage::QualitiesRemoveDataIdEvent(s2c::QualitiesRemoveDataIdEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateRemoveInstanceIdEvent => Ok(S2CMessage::QualitiesPrivateRemoveInstanceIdEvent(s2c::QualitiesPrivateRemoveInstanceIdEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesRemoveInstanceIdEvent => Ok(S2CMessage::QualitiesRemoveInstanceIdEvent(s2c::QualitiesRemoveInstanceIdEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateRemovePositionEvent => Ok(S2CMessage::QualitiesPrivateRemovePositionEvent(s2c::QualitiesPrivateRemovePositionEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesRemovePositionEvent => Ok(S2CMessage::QualitiesRemovePositionEvent(s2c::QualitiesRemovePositionEvent::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateRemoveInt64Event => Ok(S2CMessage::QualitiesPrivateRemoveInt64Event(s2c::QualitiesPrivateRemoveInt64Event::read(reader)?)),
            crate::enums::S2CMessage::QualitiesRemoveInt64Event => Ok(S2CMessage::QualitiesRemoveInt64Event(s2c::QualitiesRemoveInt64Event::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateInt => Ok(S2CMessage::QualitiesPrivateUpdateInt(s2c::QualitiesPrivateUpdateInt::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateInt => Ok(S2CMessage::QualitiesUpdateInt(s2c::QualitiesUpdateInt::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateInt64 => Ok(S2CMessage::QualitiesPrivateUpdateInt64(s2c::QualitiesPrivateUpdateInt64::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateInt64 => Ok(S2CMessage::QualitiesUpdateInt64(s2c::QualitiesUpdateInt64::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateBool => Ok(S2CMessage::QualitiesPrivateUpdateBool(s2c::QualitiesPrivateUpdateBool::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateBool => Ok(S2CMessage::QualitiesUpdateBool(s2c::QualitiesUpdateBool::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateFloat => Ok(S2CMessage::QualitiesPrivateUpdateFloat(s2c::QualitiesPrivateUpdateFloat::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateFloat => Ok(S2CMessage::QualitiesUpdateFloat(s2c::QualitiesUpdateFloat::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateString => Ok(S2CMessage::QualitiesPrivateUpdateString(s2c::QualitiesPrivateUpdateString::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateString => Ok(S2CMessage::QualitiesUpdateString(s2c::QualitiesUpdateString::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateDataId => Ok(S2CMessage::QualitiesPrivateUpdateDataId(s2c::QualitiesPrivateUpdateDataId::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateDataId => Ok(S2CMessage::QualitiesUpdateDataId(s2c::QualitiesUpdateDataId::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateInstanceId => Ok(S2CMessage::QualitiesPrivateUpdateInstanceId(s2c::QualitiesPrivateUpdateInstanceId::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateInstanceId => Ok(S2CMessage::QualitiesUpdateInstanceId(s2c::QualitiesUpdateInstanceId::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdatePosition => Ok(S2CMessage::QualitiesPrivateUpdatePosition(s2c::QualitiesPrivateUpdatePosition::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdatePosition => Ok(S2CMessage::QualitiesUpdatePosition(s2c::QualitiesUpdatePosition::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateSkill => Ok(S2CMessage::QualitiesPrivateUpdateSkill(s2c::QualitiesPrivateUpdateSkill::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateSkill => Ok(S2CMessage::QualitiesUpdateSkill(s2c::QualitiesUpdateSkill::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateSkillLevel => Ok(S2CMessage::QualitiesPrivateUpdateSkillLevel(s2c::QualitiesPrivateUpdateSkillLevel::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateSkillLevel => Ok(S2CMessage::QualitiesUpdateSkillLevel(s2c::QualitiesUpdateSkillLevel::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateSkillAC => Ok(S2CMessage::QualitiesPrivateUpdateSkillAC(s2c::QualitiesPrivateUpdateSkillAC::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateSkillAC => Ok(S2CMessage::QualitiesUpdateSkillAC(s2c::QualitiesUpdateSkillAC::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateAttribute => Ok(S2CMessage::QualitiesPrivateUpdateAttribute(s2c::QualitiesPrivateUpdateAttribute::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateAttribute => Ok(S2CMessage::QualitiesUpdateAttribute(s2c::QualitiesUpdateAttribute::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateAttributeLevel => Ok(S2CMessage::QualitiesPrivateUpdateAttributeLevel(s2c::QualitiesPrivateUpdateAttributeLevel::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateAttributeLevel => Ok(S2CMessage::QualitiesUpdateAttributeLevel(s2c::QualitiesUpdateAttributeLevel::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateAttribute2nd => Ok(S2CMessage::QualitiesPrivateUpdateAttribute2nd(s2c::QualitiesPrivateUpdateAttribute2nd::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateAttribute2nd => Ok(S2CMessage::QualitiesUpdateAttribute2nd(s2c::QualitiesUpdateAttribute2nd::read(reader)?)),
            crate::enums::S2CMessage::QualitiesPrivateUpdateAttribute2ndLevel => Ok(S2CMessage::QualitiesPrivateUpdateAttribute2ndLevel(s2c::QualitiesPrivateUpdateAttribute2ndLevel::read(reader)?)),
            crate::enums::S2CMessage::QualitiesUpdateAttribute2ndLevel => Ok(S2CMessage::QualitiesUpdateAttribute2ndLevel(s2c::QualitiesUpdateAttribute2ndLevel::read(reader)?)),
            crate::enums::S2CMessage::CommunicationHearEmote => Ok(S2CMessage::CommunicationHearEmote(s2c::CommunicationHearEmote::read(reader)?)),
            crate::enums::S2CMessage::CommunicationHearSoulEmote => Ok(S2CMessage::CommunicationHearSoulEmote(s2c::CommunicationHearSoulEmote::read(reader)?)),
            crate::enums::S2CMessage::CommunicationHearSpeech => Ok(S2CMessage::CommunicationHearSpeech(s2c::CommunicationHearSpeech::read(reader)?)),
            crate::enums::S2CMessage::CommunicationHearRangedSpeech => Ok(S2CMessage::CommunicationHearRangedSpeech(s2c::CommunicationHearRangedSpeech::read(reader)?)),
            crate::enums::S2CMessage::AdminEnvirons => Ok(S2CMessage::AdminEnvirons(s2c::AdminEnvirons::read(reader)?)),
            crate::enums::S2CMessage::MovementPositionAndMovementEvent => Ok(S2CMessage::MovementPositionAndMovementEvent(s2c::MovementPositionAndMovementEvent::read(reader)?)),
            crate::enums::S2CMessage::ItemObjDescEvent => Ok(S2CMessage::ItemObjDescEvent(s2c::ItemObjDescEvent::read(reader)?)),
            crate::enums::S2CMessage::CharacterSetPlayerVisualDesc => Ok(S2CMessage::CharacterSetPlayerVisualDesc(s2c::CharacterSetPlayerVisualDesc::read(reader)?)),
            crate::enums::S2CMessage::CharacterCharGenVerificationResponse => Ok(S2CMessage::CharacterCharGenVerificationResponse(s2c::CharacterCharGenVerificationResponse::read(reader)?)),
            crate::enums::S2CMessage::LoginAwaitingSubscriptionExpiration => Ok(S2CMessage::LoginAwaitingSubscriptionExpiration(s2c::LoginAwaitingSubscriptionExpiration::read(reader)?)),
            crate::enums::S2CMessage::LoginLogOffCharacter => Ok(S2CMessage::LoginLogOffCharacter(s2c::LoginLogOffCharacter::read(reader)?)),
            crate::enums::S2CMessage::CharacterCharacterDelete => Ok(S2CMessage::CharacterCharacterDelete(s2c::CharacterCharacterDelete::read(reader)?)),
            crate::enums::S2CMessage::LoginLoginCharacterSet => Ok(S2CMessage::LoginLoginCharacterSet(s2c::LoginLoginCharacterSet::read(reader)?)),
            crate::enums::S2CMessage::CharacterCharacterError => Ok(S2CMessage::CharacterCharacterError(s2c::CharacterCharacterError::read(reader)?)),
            crate::enums::S2CMessage::ItemCreateObject => Ok(S2CMessage::ItemCreateObject(s2c::ItemCreateObject::read(reader)?)),
            crate::enums::S2CMessage::LoginCreatePlayer => Ok(S2CMessage::LoginCreatePlayer(s2c::LoginCreatePlayer::read(reader)?)),
            crate::enums::S2CMessage::ItemDeleteObject => Ok(S2CMessage::ItemDeleteObject(s2c::ItemDeleteObject::read(reader)?)),
            crate::enums::S2CMessage::MovementPositionEvent => Ok(S2CMessage::MovementPositionEvent(s2c::MovementPositionEvent::read(reader)?)),
            crate::enums::S2CMessage::ItemParentEvent => Ok(S2CMessage::ItemParentEvent(s2c::ItemParentEvent::read(reader)?)),
            crate::enums::S2CMessage::InventoryPickupEvent => Ok(S2CMessage::InventoryPickupEvent(s2c::InventoryPickupEvent::read(reader)?)),
            crate::enums::S2CMessage::ItemSetState => Ok(S2CMessage::ItemSetState(s2c::ItemSetState::read(reader)?)),
            crate::enums::S2CMessage::MovementSetObjectMovement => Ok(S2CMessage::MovementSetObjectMovement(s2c::MovementSetObjectMovement::read(reader)?)),
            crate::enums::S2CMessage::MovementVectorUpdate => Ok(S2CMessage::MovementVectorUpdate(s2c::MovementVectorUpdate::read(reader)?)),
            crate::enums::S2CMessage::EffectsSoundEvent => Ok(S2CMessage::EffectsSoundEvent(s2c::EffectsSoundEvent::read(reader)?)),
            crate::enums::S2CMessage::EffectsPlayerTeleport => Ok(S2CMessage::EffectsPlayerTeleport(s2c::EffectsPlayerTeleport::read(reader)?)),
            crate::enums::S2CMessage::EffectsPlayScriptId => Ok(S2CMessage::EffectsPlayScriptId(s2c::EffectsPlayScriptId::read(reader)?)),
            crate::enums::S2CMessage::EffectsPlayScriptType => Ok(S2CMessage::EffectsPlayScriptType(s2c::EffectsPlayScriptType::read(reader)?)),
            crate::enums::S2CMessage::LoginAccountBanned => Ok(S2CMessage::LoginAccountBanned(s2c::LoginAccountBanned::read(reader)?)),
            crate::enums::S2CMessage::AdminReceiveAccountData => Ok(S2CMessage::AdminReceiveAccountData(s2c::AdminReceiveAccountData::read(reader)?)),
            crate::enums::S2CMessage::AdminReceivePlayerData => Ok(S2CMessage::AdminReceivePlayerData(s2c::AdminReceivePlayerData::read(reader)?)),
            crate::enums::S2CMessage::ItemUpdateObject => Ok(S2CMessage::ItemUpdateObject(s2c::ItemUpdateObject::read(reader)?)),
            crate::enums::S2CMessage::LoginAccountBooted => Ok(S2CMessage::LoginAccountBooted(s2c::LoginAccountBooted::read(reader)?)),
            crate::enums::S2CMessage::CommunicationTurbineChat => Ok(S2CMessage::CommunicationTurbineChat(s2c::CommunicationTurbineChat::read(reader)?)),
            crate::enums::S2CMessage::LoginEnterGameServerReady => Ok(S2CMessage::LoginEnterGameServerReady(s2c::LoginEnterGameServerReady::read(reader)?)),
            crate::enums::S2CMessage::CommunicationTextboxString => Ok(S2CMessage::CommunicationTextboxString(s2c::CommunicationTextboxString::read(reader)?)),
            crate::enums::S2CMessage::LoginWorldInfo => Ok(S2CMessage::LoginWorldInfo(s2c::LoginWorldInfo::read(reader)?)),
            crate::enums::S2CMessage::DDDDataMessage => Ok(S2CMessage::DDDDataMessage(s2c::DDDDataMessage::read(reader)?)),
            crate::enums::S2CMessage::DDDErrorMessage => Ok(S2CMessage::DDDErrorMessage(s2c::DDDErrorMessage::read(reader)?)),
            crate::enums::S2CMessage::DDDBeginDDDMessage => Ok(S2CMessage::DDDBeginDDDMessage(s2c::DDDBeginDDDMessage::read(reader)?)),
            crate::enums::S2CMessage::DDDInterrogationMessage => Ok(S2CMessage::DDDInterrogationMessage(s2c::DDDInterrogationMessage::read(reader)?)),
            crate::enums::S2CMessage::DDDOnEndDDD => Ok(S2CMessage::DDDOnEndDDD(s2c::DDDOnEndDDD::read(reader)?)),
            crate::enums::S2CMessage::OrderedGameEvent => {
                let object_id = read_u32(reader)?;
                let sequence = read_u32(reader)?;
                let event = Box::new(GameEventMessage::read(reader)?);
                Ok(S2CMessage::OrderedGameEvent { object_id, sequence, event })
            }
        }
    }

    pub fn queue(&self) -> Option<MessageQueue> {
        match self {
            S2CMessage::ItemServerSaysRemove(_) => Some(MessageQueue::UIQueue),
            S2CMessage::CharacterServerSaysAttemptFailed(_) => Some(MessageQueue::UIQueue),
            S2CMessage::ItemUpdateStackSize(_) => Some(MessageQueue::UIQueue),
            S2CMessage::CombatHandlePlayerDeathEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateRemoveIntEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesRemoveIntEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateRemoveBoolEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesRemoveBoolEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateRemoveFloatEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesRemoveFloatEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateRemoveStringEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesRemoveStringEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateRemoveDataIdEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesRemoveDataIdEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateRemoveInstanceIdEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesRemoveInstanceIdEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateRemovePositionEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesRemovePositionEvent(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateRemoveInt64Event(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesRemoveInt64Event(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateInt(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateInt(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateInt64(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateInt64(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateBool(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateBool(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateFloat(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateFloat(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateString(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateString(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateDataId(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateDataId(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateInstanceId(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateInstanceId(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdatePosition(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdatePosition(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateSkill(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateSkill(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateSkillLevel(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateSkillLevel(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateSkillAC(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateSkillAC(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateAttribute(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateAttribute(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateAttributeLevel(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateAttributeLevel(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateAttribute2nd(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateAttribute2nd(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesPrivateUpdateAttribute2ndLevel(_) => Some(MessageQueue::UIQueue),
            S2CMessage::QualitiesUpdateAttribute2ndLevel(_) => Some(MessageQueue::UIQueue),
            S2CMessage::CommunicationHearEmote(_) => Some(MessageQueue::UIQueue),
            S2CMessage::CommunicationHearSoulEmote(_) => Some(MessageQueue::UIQueue),
            S2CMessage::CommunicationHearSpeech(_) => Some(MessageQueue::UIQueue),
            S2CMessage::CommunicationHearRangedSpeech(_) => Some(MessageQueue::UIQueue),
            S2CMessage::AdminEnvirons(_) => Some(MessageQueue::UIQueue),
            S2CMessage::MovementPositionAndMovementEvent(_) => Some(MessageQueue::SmartBox),
            S2CMessage::ItemObjDescEvent(_) => Some(MessageQueue::SmartBox),
            S2CMessage::CharacterSetPlayerVisualDesc(_) => Some(MessageQueue::UIQueue),
            S2CMessage::CharacterCharGenVerificationResponse(_) => Some(MessageQueue::UIQueue),
            S2CMessage::LoginAwaitingSubscriptionExpiration(_) => Some(MessageQueue::UIQueue),
            S2CMessage::LoginLogOffCharacter(_) => Some(MessageQueue::UIQueue),
            S2CMessage::CharacterCharacterDelete(_) => Some(MessageQueue::UIQueue),
            S2CMessage::LoginLoginCharacterSet(_) => Some(MessageQueue::UIQueue),
            S2CMessage::CharacterCharacterError(_) => Some(MessageQueue::UIQueue),
            S2CMessage::ItemCreateObject(_) => Some(MessageQueue::SmartBox),
            S2CMessage::LoginCreatePlayer(_) => Some(MessageQueue::SmartBox),
            S2CMessage::ItemDeleteObject(_) => Some(MessageQueue::SmartBox),
            S2CMessage::MovementPositionEvent(_) => Some(MessageQueue::SmartBox),
            S2CMessage::ItemParentEvent(_) => Some(MessageQueue::SmartBox),
            S2CMessage::InventoryPickupEvent(_) => Some(MessageQueue::SmartBox),
            S2CMessage::ItemSetState(_) => Some(MessageQueue::SmartBox),
            S2CMessage::MovementSetObjectMovement(_) => Some(MessageQueue::SmartBox),
            S2CMessage::MovementVectorUpdate(_) => Some(MessageQueue::SmartBox),
            S2CMessage::EffectsSoundEvent(_) => Some(MessageQueue::SmartBox),
            S2CMessage::EffectsPlayerTeleport(_) => Some(MessageQueue::SmartBox),
            S2CMessage::EffectsPlayScriptId(_) => Some(MessageQueue::SmartBox),
            S2CMessage::EffectsPlayScriptType(_) => Some(MessageQueue::SmartBox),
            S2CMessage::LoginAccountBanned(_) => Some(MessageQueue::UIQueue),
            S2CMessage::AdminReceiveAccountData(_) => Some(MessageQueue::UIQueue),
            S2CMessage::AdminReceivePlayerData(_) => Some(MessageQueue::UIQueue),
            S2CMessage::ItemUpdateObject(_) => Some(MessageQueue::SmartBox),
            S2CMessage::LoginAccountBooted(_) => Some(MessageQueue::UIQueue),
            S2CMessage::CommunicationTurbineChat(_) => Some(MessageQueue::Logon),
            S2CMessage::LoginEnterGameServerReady(_) => Some(MessageQueue::UIQueue),
            S2CMessage::CommunicationTextboxString(_) => Some(MessageQueue::UIQueue),
            S2CMessage::LoginWorldInfo(_) => Some(MessageQueue::UIQueue),
            S2CMessage::DDDDataMessage(_) => Some(MessageQueue::CLCache),
            S2CMessage::DDDErrorMessage(_) => Some(MessageQueue::CLCache),
            S2CMessage::DDDBeginDDDMessage(_) => Some(MessageQueue::CLCache),
            S2CMessage::DDDInterrogationMessage(_) => Some(MessageQueue::CLCache),
            S2CMessage::DDDOnEndDDD(_) => Some(MessageQueue::CLCache),
            S2CMessage::OrderedGameEvent { event, .. } => event.queue(),
        }
    }
}

